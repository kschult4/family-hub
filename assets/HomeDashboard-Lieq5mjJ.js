const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/index-CkcIAYgn.js","assets/motion-DtcReM-G.js","assets/vendor-DBiAVD-u.js","assets/firebase-CEraX8R7.js","assets/index-GBxiWWf7.css"])))=>i.map(i=>d[i]);
var Ye=Object.defineProperty,et=Object.defineProperties;var tt=Object.getOwnPropertyDescriptors;var Oe=Object.getOwnPropertySymbols;var st=Object.prototype.hasOwnProperty,at=Object.prototype.propertyIsEnumerable;var Ue=(t,s,n)=>s in t?Ye(t,s,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[s]=n,J=(t,s)=>{for(var n in s||(s={}))st.call(s,n)&&Ue(t,n,s[n]);if(Oe)for(var n of Oe(s))at.call(s,n)&&Ue(t,n,s[n]);return t},ee=(t,s)=>et(t,tt(s));var _=(t,s,n)=>new Promise((a,m)=>{var p=E=>{try{h(n.next(E))}catch(P){m(P)}},C=E=>{try{h(n.throw(E))}catch(P){m(P)}},h=E=>E.done?a(E.value):Promise.resolve(E.value).then(p,C);h((n=n.apply(t,s)).next())});import{r as i,j as e}from"./motion-DtcReM-G.js";import{_ as Ee,h as Ce,a as rt}from"./index-CkcIAYgn.js";import{c as F,X as we,a as be,V as Be}from"./x-DlX-TBMt.js";import{S as Fe}from"./SectionHeader-1je8yYJT.js";import"./vendor-DBiAVD-u.js";import"./firebase-CEraX8R7.js";/**
 * @license lucide-react v0.536.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nt=[["rect",{width:"16",height:"20",x:"4",y:"2",rx:"2",ry:"2",key:"76otgf"}],["path",{d:"M9 22v-4h6v4",key:"r93iot"}],["path",{d:"M8 6h.01",key:"1dz90k"}],["path",{d:"M16 6h.01",key:"1x0f13"}],["path",{d:"M12 6h.01",key:"1vi96p"}],["path",{d:"M12 10h.01",key:"1nrarc"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M16 10h.01",key:"1m94wz"}],["path",{d:"M16 14h.01",key:"1gbofw"}],["path",{d:"M8 10h.01",key:"19clt8"}],["path",{d:"M8 14h.01",key:"6423bh"}]],it=F("building",nt);/**
 * @license lucide-react v0.536.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lt=[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]],ot=F("check",lt);/**
 * @license lucide-react v0.536.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ct=[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]],Le=F("chevron-down",ct);/**
 * @license lucide-react v0.536.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dt=[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]],mt=F("chevron-up",dt);/**
 * @license lucide-react v0.536.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ut=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]],He=F("circle-check",ut);/**
 * @license lucide-react v0.536.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ht=[["path",{d:"M9 9.003a1 1 0 0 1 1.517-.859l4.997 2.997a1 1 0 0 1 0 1.718l-4.997 2.997A1 1 0 0 1 9 14.996z",key:"kmsa83"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],gt=F("circle-play",ht);/**
 * @license lucide-react v0.536.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xt=[["path",{d:"M8.5 14.5A2.5 2.5 0 0 0 11 12c0-1.38-.5-2-1-3-1.072-2.143-.224-4.054 2-6 .5 2.5 2 4.9 4 6.5 2 1.6 3 3.5 3 5.5a7 7 0 1 1-14 0c0-1.153.433-2.294 1-3a2.5 2.5 0 0 0 2.5 2.5z",key:"96xj49"}]],ft=F("flame",xt);/**
 * @license lucide-react v0.536.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pt=[["path",{d:"M15 21v-8a1 1 0 0 0-1-1h-4a1 1 0 0 0-1 1v8",key:"5wwlr5"}],["path",{d:"M3 10a2 2 0 0 1 .709-1.528l7-5.999a2 2 0 0 1 2.582 0l7 5.999A2 2 0 0 1 21 10v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"1d0kgt"}]],ve=F("house",pt);/**
 * @license lucide-react v0.536.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bt=[["path",{d:"M2.586 17.414A2 2 0 0 0 2 18.828V21a1 1 0 0 0 1 1h3a1 1 0 0 0 1-1v-1a1 1 0 0 1 1-1h1a1 1 0 0 0 1-1v-1a1 1 0 0 1 1-1h.172a2 2 0 0 0 1.414-.586l.814-.814a6.5 6.5 0 1 0-4-4z",key:"1s6t7t"}],["circle",{cx:"16.5",cy:"7.5",r:".5",fill:"currentColor",key:"w0ekpg"}]],yt=F("key-round",bt);/**
 * @license lucide-react v0.536.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wt=[["path",{d:"M15 14c.2-1 .7-1.7 1.5-2.5 1-.9 1.5-2.2 1.5-3.5A6 6 0 0 0 6 8c0 1 .2 2.2 1.5 3.5.7.7 1.3 1.5 1.5 2.5",key:"1gvzjb"}],["path",{d:"M9 18h6",key:"x1upvd"}],["path",{d:"M10 22h4",key:"ceow96"}]],ze=F("lightbulb",wt);/**
 * @license lucide-react v0.536.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vt=[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 9.9-1",key:"1mm8w8"}]],jt=F("lock-open",vt);/**
 * @license lucide-react v0.536.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Nt=[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]],Ve=F("lock",Nt);/**
 * @license lucide-react v0.536.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _t=[["path",{d:"M5 12h14",key:"1ays0h"}]],Qe=F("minus",_t);/**
 * @license lucide-react v0.536.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kt=[["path",{d:"M9 18V5l12-2v13",key:"1jmyc2"}],["circle",{cx:"6",cy:"18",r:"3",key:"fqmcym"}],["circle",{cx:"18",cy:"16",r:"3",key:"1hluhg"}]],ce=F("music",kt);/**
 * @license lucide-react v0.536.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const St=[["path",{d:"M12 22a1 1 0 0 1 0-20 10 9 0 0 1 10 9 5 5 0 0 1-5 5h-2.25a1.75 1.75 0 0 0-1.4 2.8l.3.4a1.75 1.75 0 0 1-1.4 2.8z",key:"e79jfc"}],["circle",{cx:"13.5",cy:"6.5",r:".5",fill:"currentColor",key:"1okk4w"}],["circle",{cx:"17.5",cy:"10.5",r:".5",fill:"currentColor",key:"f64h9f"}],["circle",{cx:"6.5",cy:"12.5",r:".5",fill:"currentColor",key:"qy21gx"}],["circle",{cx:"8.5",cy:"7.5",r:".5",fill:"currentColor",key:"fotxhn"}]],Ct=F("palette",St);/**
 * @license lucide-react v0.536.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Mt=[["rect",{x:"14",y:"3",width:"5",height:"18",rx:"1",key:"kaeet6"}],["rect",{x:"5",y:"3",width:"5",height:"18",rx:"1",key:"1wsw3u"}]],Je=F("pause",Mt);/**
 * @license lucide-react v0.536.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Tt=[["path",{d:"M13 21h8",key:"1jsn5i"}],["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}]],Ge=F("pen-line",Tt);/**
 * @license lucide-react v0.536.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const At=[["path",{d:"M5 5a2 2 0 0 1 3.008-1.728l11.997 6.998a2 2 0 0 1 .003 3.458l-12 7A2 2 0 0 1 5 19z",key:"10ikf1"}]],De=F("play",At);/**
 * @license lucide-react v0.536.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $t=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]],ye=F("plus",$t);/**
 * @license lucide-react v0.536.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Et=[["path",{d:"M12 2v10",key:"mnfbl"}],["path",{d:"M18.4 6.6a9 9 0 1 1-12.77.04",key:"obofu9"}]],Pe=F("power",Et);/**
 * @license lucide-react v0.536.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Pt=[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}],["path",{d:"M12 8v4",key:"1got3b"}],["path",{d:"M12 16h.01",key:"1drbdi"}]],Ke=F("shield-alert",Pt);/**
 * @license lucide-react v0.536.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Rt=[["path",{d:"M7 18v-6a5 5 0 1 1 10 0v6",key:"pcx96s"}],["path",{d:"M5 21a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1v-1a2 2 0 0 0-2-2H7a2 2 0 0 0-2 2z",key:"1b4s83"}],["path",{d:"M21 12h1",key:"jtio3y"}],["path",{d:"M18.5 4.5 18 5",key:"g5sp9y"}],["path",{d:"M2 12h1",key:"1uaihz"}],["path",{d:"M12 2v1",key:"11qlp1"}],["path",{d:"m4.929 4.929.707.707",key:"1i51kw"}],["path",{d:"M12 12v6",key:"3ahymv"}]],$e=F("siren",Rt);/**
 * @license lucide-react v0.536.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Lt=[["path",{d:"M17.971 4.285A2 2 0 0 1 21 6v12a2 2 0 0 1-3.029 1.715l-9.997-5.998a2 2 0 0 1-.003-3.432z",key:"15892j"}],["path",{d:"M3 20V4",key:"1ptbpl"}]],Ze=F("skip-back",Lt);/**
 * @license lucide-react v0.536.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zt=[["path",{d:"M21 4v16",key:"7j8fe9"}],["path",{d:"M6.029 4.285A2 2 0 0 0 3 6v12a2 2 0 0 0 3.029 1.715l9.997-5.998a2 2 0 0 0 .003-3.432z",key:"zs4d6"}]],Xe=F("skip-forward",zt);/**
 * @license lucide-react v0.536.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Dt=[["path",{d:"m10 20-1.25-2.5L6 18",key:"18frcb"}],["path",{d:"M10 4 8.75 6.5 6 6",key:"7mghy3"}],["path",{d:"m14 20 1.25-2.5L18 18",key:"1chtki"}],["path",{d:"m14 4 1.25 2.5L18 6",key:"1b4wsy"}],["path",{d:"m17 21-3-6h-4",key:"15hhxa"}],["path",{d:"m17 3-3 6 1.5 3",key:"11697g"}],["path",{d:"M2 12h6.5L10 9",key:"kv9z4n"}],["path",{d:"m20 10-1.5 2 1.5 2",key:"1swlpi"}],["path",{d:"M22 12h-6.5L14 15",key:"1mxi28"}],["path",{d:"m4 10 1.5 2L4 14",key:"k9enpj"}],["path",{d:"m7 21 3-6-1.5-3",key:"j8hb9u"}],["path",{d:"m7 3 3 6h4",key:"1otusx"}]],Ot=F("snowflake",Dt);/**
 * @license lucide-react v0.536.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ut=[["circle",{cx:"12",cy:"12",r:"4",key:"4exip2"}],["path",{d:"M12 2v2",key:"tus03m"}],["path",{d:"M12 20v2",key:"1lh1kg"}],["path",{d:"m4.93 4.93 1.41 1.41",key:"149t6j"}],["path",{d:"m17.66 17.66 1.41 1.41",key:"ptbguv"}],["path",{d:"M2 12h2",key:"1t8f8n"}],["path",{d:"M20 12h2",key:"1q8mjw"}],["path",{d:"m6.34 17.66-1.41 1.41",key:"1m8zz5"}],["path",{d:"m19.07 4.93-1.41 1.41",key:"1shlcs"}]],Bt=F("sun",Ut);/**
 * @license lucide-react v0.536.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ft=[["path",{d:"M14 4v10.54a4 4 0 1 1-4 0V4a2 2 0 0 1 4 0Z",key:"17jzev"}]],Ht=F("thermometer",Ft);/**
 * @license lucide-react v0.536.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Gt=[["circle",{cx:"9",cy:"12",r:"3",key:"u3jwor"}],["rect",{width:"20",height:"14",x:"2",y:"5",rx:"7",key:"g7kal2"}]],Re=F("toggle-left",Gt);/**
 * @license lucide-react v0.536.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Wt=[["circle",{cx:"15",cy:"12",r:"3",key:"1afu0r"}],["rect",{width:"20",height:"14",x:"2",y:"5",rx:"7",key:"g7kal2"}]],It=F("toggle-right",Wt);/**
 * @license lucide-react v0.536.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qt=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["path",{d:"M16 3.128a4 4 0 0 1 0 7.744",key:"16gr8j"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}]],he=F("users",qt);/**
 * @license lucide-react v0.536.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Vt=[["path",{d:"M12 20h.01",key:"zekei9"}],["path",{d:"M2 8.82a15 15 0 0 1 20 0",key:"dnpr2z"}],["path",{d:"M5 12.859a10 10 0 0 1 14 0",key:"1x1e6c"}],["path",{d:"M8.5 16.429a5 5 0 0 1 7 0",key:"1bycff"}]],Qt=F("wifi",Vt);/**
 * @license lucide-react v0.536.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Jt=[["path",{d:"M12.8 19.6A2 2 0 1 0 14 16H2",key:"148xed"}],["path",{d:"M17.5 8a2.5 2.5 0 1 1 2 4H2",key:"1u4tom"}],["path",{d:"M9.8 4.4A2 2 0 1 1 11 8H2",key:"75valh"}]],Kt=F("wind",Jt);/**
 * @license lucide-react v0.536.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Zt=[["path",{d:"M4 14a1 1 0 0 1-.78-1.63l9.9-10.2a.5.5 0 0 1 .86.46l-1.92 6.02A1 1 0 0 0 13 10h7a1 1 0 0 1 .78 1.63l-9.9 10.2a.5.5 0 0 1-.86-.46l1.92-6.02A1 1 0 0 0 11 14z",key:"1xq2db"}]],We=F("zap",Zt),Ie={light:t=>({id:t.entity_id,name:t.attributes.friendly_name||t.entity_id,type:"light",state:t.state,isOn:t.state==="on",brightness:t.attributes.brightness||0,brightnessPercent:Math.round((t.attributes.brightness||0)/255*100),colorMode:t.attributes.color_mode,rgbColor:t.attributes.rgb_color,hsColor:t.attributes.hs_color,colorTemp:t.attributes.color_temp,supportedFeatures:t.attributes.supported_features||0,icon:t.attributes.icon,lastChanged:t.last_changed,lastUpdated:t.last_updated,raw:t}),switch:t=>({id:t.entity_id,name:t.attributes.friendly_name||t.entity_id,type:"switch",state:t.state,isOn:t.state==="on",icon:t.attributes.icon,deviceClass:t.attributes.device_class,lastChanged:t.last_changed,lastUpdated:t.last_updated,raw:t}),climate:t=>({id:t.entity_id,name:t.attributes.friendly_name||t.entity_id,type:"climate",state:t.state,currentTemp:t.attributes.current_temperature,targetTemp:t.attributes.temperature,targetTempHigh:t.attributes.target_temp_high,targetTempLow:t.attributes.target_temp_low,hvacMode:t.attributes.hvac_mode,hvacModes:t.attributes.hvac_modes||[],hvacAction:t.attributes.hvac_action,fanMode:t.attributes.fan_mode,fanModes:t.attributes.fan_modes||[],presetMode:t.attributes.preset_mode,presetModes:t.attributes.preset_modes||[],humidity:t.attributes.current_humidity,targetHumidity:t.attributes.humidity,minTemp:t.attributes.min_temp,maxTemp:t.attributes.max_temp,tempStep:t.attributes.target_temp_step,supportedFeatures:t.attributes.supported_features||0,icon:t.attributes.icon,lastChanged:t.last_changed,lastUpdated:t.last_updated,raw:t}),media_player:t=>({id:t.entity_id,name:t.attributes.friendly_name||t.entity_id,type:"media_player",state:t.state,isPlaying:t.state==="playing",isPaused:t.state==="paused",isIdle:t.state==="idle",isOff:t.state==="off",volumeLevel:t.attributes.volume_level,isMuted:t.attributes.is_volume_muted,mediaTitle:t.attributes.media_title,mediaArtist:t.attributes.media_artist,mediaAlbum:t.attributes.media_album,mediaArtwork:t.attributes.entity_picture,mediaDuration:t.attributes.media_duration,mediaPosition:t.attributes.media_position,mediaPositionUpdatedAt:t.attributes.media_position_updated_at,shuffle:t.attributes.shuffle,repeat:t.attributes.repeat,supportedFeatures:t.attributes.supported_features||0,groupMembers:t.attributes.group_members||[],icon:t.attributes.icon,lastChanged:t.last_changed,lastUpdated:t.last_updated,raw:t}),alarm_control_panel:t=>({id:t.entity_id,name:t.attributes.friendly_name||t.entity_id,type:"alarm_control_panel",state:t.state,isArmed:["armed_home","armed_away","armed_night","armed_vacation"].includes(t.state),isDisarmed:t.state==="disarmed",isPending:t.state==="pending",isTriggered:t.state==="triggered",supportedFeatures:t.attributes.supported_features||0,codeArmRequired:t.attributes.code_arm_required,codeFormat:t.attributes.code_format,changedBy:t.attributes.changed_by,icon:t.attributes.icon,lastChanged:t.last_changed,lastUpdated:t.last_updated,raw:t}),camera:t=>({id:t.entity_id,name:t.attributes.friendly_name||t.entity_id,type:"camera",state:t.state,isIdle:t.state==="idle",isStreaming:t.state==="streaming",isRecording:t.state==="recording",entityPicture:t.attributes.entity_picture,supportedFeatures:t.attributes.supported_features||0,frontendStreamType:t.attributes.frontend_stream_type,brandName:t.attributes.brand,modelName:t.attributes.model_name,motionDetection:t.attributes.motion_detection,icon:t.attributes.icon,lastChanged:t.last_changed,lastUpdated:t.last_updated,raw:t}),scene:t=>({id:t.entity_id,name:t.attributes.friendly_name||t.entity_id,type:"scene",state:t.state,icon:t.attributes.icon,lastChanged:t.last_changed,lastUpdated:t.last_updated,raw:t}),default:t=>({id:t.entity_id,name:t.attributes.friendly_name||t.entity_id,type:t.entity_id.split(".")[0],state:t.state,attributes:t.attributes,icon:t.attributes.icon,lastChanged:t.last_changed,lastUpdated:t.last_updated,raw:t})};function qe(t){const s=t.entity_id.split(".")[0];return(Ie[s]||Ie.default)(t)}const ne={light:{turnOn:(t,s={})=>({domain:"light",service:"turn_on",data:J({entity_id:t},s)}),turnOff:t=>({domain:"light",service:"turn_off",data:{entity_id:t}}),setBrightness:(t,s)=>({domain:"light",service:"turn_on",data:{entity_id:t,brightness:Math.round(s/100*255)}}),setColor:(t,s)=>({domain:"light",service:"turn_on",data:{entity_id:t,rgb_color:s}})},climate:{setTemperature:(t,s)=>({domain:"climate",service:"set_temperature",data:{entity_id:t,temperature:s}}),setHvacMode:(t,s)=>({domain:"climate",service:"set_hvac_mode",data:{entity_id:t,hvac_mode:s}}),setFanMode:(t,s)=>({domain:"climate",service:"set_fan_mode",data:{entity_id:t,fan_mode:s}}),setPreset:(t,s)=>({domain:"climate",service:"set_preset_mode",data:{entity_id:t,preset_mode:s}})},media_player:{playMedia:(t,s,n)=>({domain:"media_player",service:"play_media",data:{entity_id:t,media_content_id:s,media_content_type:n}}),volumeSet:(t,s)=>({domain:"media_player",service:"volume_set",data:{entity_id:t,volume_level:s}}),mediaNext:t=>({domain:"media_player",service:"media_next_track",data:{entity_id:t}}),mediaPrevious:t=>({domain:"media_player",service:"media_previous_track",data:{entity_id:t}}),mediaPlayPause:t=>({domain:"media_player",service:"media_play_pause",data:{entity_id:t}}),joinGroup:(t,s)=>({domain:"media_player",service:"join",data:{entity_id:t,group_members:s}}),unjoinGroup:t=>({domain:"media_player",service:"unjoin",data:{entity_id:t}})},alarm_control_panel:{disarm:(t,s)=>({domain:"alarm_control_panel",service:"alarm_disarm",data:J({entity_id:t},s&&{code:s})}),armHome:(t,s)=>({domain:"alarm_control_panel",service:"alarm_arm_home",data:J({entity_id:t},s&&{code:s})}),armAway:(t,s)=>({domain:"alarm_control_panel",service:"alarm_arm_away",data:J({entity_id:t},s&&{code:s})}),armNight:(t,s)=>({domain:"alarm_control_panel",service:"alarm_arm_night",data:J({entity_id:t},s&&{code:s})})}};class Xt{constructor(s={}){var n;this.baseUrl=s.baseUrl||"http://192.168.1.224:8123",this.token=s.token||"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiI3NWRkNDU2YTg4YTA0Zjg5YWFmZGJjMzE0ZjNjODE3MyIsImlhdCI6MTc1NTc4NjA1MSwiZXhwIjoyMDcxMTQ2MDUxfQ.2gBQcR43Vjaezd4wouDD8TwIGdxLuqSMZvw0uGHDsVM",this.useMockData=(n=s.useMockData)!=null?n:!1,this.ws=null,this.subscribers=new Map,this.entityCache=new Map,this.isConnected=!1,this.connect=this.connect.bind(this),this.disconnect=this.disconnect.bind(this),this.subscribe=this.subscribe.bind(this),this.unsubscribe=this.unsubscribe.bind(this)}connect(){return _(this,null,function*(){if(this.useMockData||!this.baseUrl||!this.token){this.isConnected=!0;return}try{console.log("🔌 Testing Home Assistant REST API connection...");const s=!1,n=s?"/api/ha/api/":`${this.baseUrl}/api/`,a=s?{"Content-Type":"application/json"}:{Authorization:`Bearer ${this.token}`,"Content-Type":"application/json"},m=yield fetch(n,{headers:a});if(!m.ok)throw new Error(`HTTP ${m.status}: ${m.statusText}`);const p=yield m.json();return console.log("✅ Home Assistant REST API connected:",p.message),this.ws=null,this.isConnected=!0,this.startPolling(),()=>{}}catch(s){throw console.error("❌ Failed to connect to Home Assistant REST API:",s),this.isConnected=!1,s}})}startPolling(){this.ws||this.subscribers.size===0||(this.pollingInterval=setInterval(()=>_(this,null,function*(){try{const s=Array.from(this.subscribers.keys()).filter(n=>n!=="*");if(s.length>0){const n=yield this.getStates();s.forEach(a=>{const m=n.find(C=>C.id===a),p=this.subscribers.get(a);m&&p&&p.forEach(C=>{try{C(m)}catch(h){console.error("Error in polling subscriber callback:",h)}})})}}catch(s){console.error("Error during polling:",s),(s.message.includes("Failed to fetch")||s.message.includes("INSUFFICIENT_RESOURCES"))&&(console.log("Stopping polling due to network errors"),this.stopPolling())}}),5e3))}stopPolling(){this.pollingInterval&&(clearInterval(this.pollingInterval),this.pollingInterval=null)}disconnect(){this.ws&&(this.ws.close(),this.ws=null),this.stopPolling(),this.isConnected=!1,this.subscribers.clear()}subscribe(s,n){return this.subscribers.has(s)||this.subscribers.set(s,new Set),this.subscribers.get(s).add(n),!this.ws&&this.isConnected&&this.startPolling(),()=>{const a=this.subscribers.get(s);a&&(a.delete(n),a.size===0&&this.subscribers.delete(s)),this.subscribers.size===0&&this.stopPolling()}}unsubscribe(s,n){const a=this.subscribers.get(s);a&&(a.delete(n),a.size===0&&this.subscribers.delete(s))}getStates(){return _(this,null,function*(){if(this.useMockData){const{mockStates:a}=yield Ee(()=>_(this,null,function*(){const{mockStates:p}=yield import("./index-CkcIAYgn.js").then(C=>C.m);return{mockStates:p}}),__vite__mapDeps([0,1,2,3,4])),m=a.map(qe);return m.forEach(p=>{this.entityCache.set(p.id,p)}),m}let s;s=yield Ce.getStates(this.baseUrl,this.token);const n=s.map(qe);return n.forEach(a=>{this.entityCache.set(a.id,a)}),n})}getEntitiesByType(s){return _(this,null,function*(){return(yield this.getStates()).filter(a=>a.type===s)})}getEntityState(s){return _(this,null,function*(){return this.entityCache.has(s)?this.entityCache.get(s):(yield this.getStates()).find(a=>a.id===s)})}callService(m,p){return _(this,arguments,function*(s,n,a={}){if(this.useMockData){console.log(`Mock: Calling service ${s}.${n}`,a);return}return yield Ce.callService(this.baseUrl,this.token,s,n,a)})}executeServiceCall(s){return _(this,null,function*(){return yield this.callService(s.domain,s.service,s.data)})}turnOnLight(a){return _(this,arguments,function*(s,n={}){const m=ne.light.turnOn(s,n);return yield this.executeServiceCall(m)})}turnOffLight(s){return _(this,null,function*(){const n=ne.light.turnOff(s);return yield this.executeServiceCall(n)})}setLightBrightness(s,n){return _(this,null,function*(){const a=ne.light.setBrightness(s,n);return yield this.executeServiceCall(a)})}setLightColor(s,n){return _(this,null,function*(){const a=ne.light.setColor(s,n);return yield this.executeServiceCall(a)})}setTemperature(s,n){return _(this,null,function*(){const a=ne.climate.setTemperature(s,n);return yield this.executeServiceCall(a)})}setHvacMode(s,n){return _(this,null,function*(){const a=ne.climate.setHvacMode(s,n);return yield this.executeServiceCall(a)})}playMedia(s,n,a){return _(this,null,function*(){const m=ne.media_player.playMedia(s,n,a);return yield this.executeServiceCall(m)})}setVolume(s,n){return _(this,null,function*(){const a=ne.media_player.volumeSet(s,n);return yield this.executeServiceCall(a)})}mediaPlayPause(s){return _(this,null,function*(){const n=ne.media_player.mediaPlayPause(s);return yield this.executeServiceCall(n)})}disarmAlarm(s,n){return _(this,null,function*(){const a=ne.alarm_control_panel.disarm(s,n);return yield this.executeServiceCall(a)})}armAlarmHome(s,n){return _(this,null,function*(){const a=ne.alarm_control_panel.armHome(s,n);return yield this.executeServiceCall(a)})}armAlarmAway(s,n){return _(this,null,function*(){const a=ne.alarm_control_panel.armAway(s,n);return yield this.executeServiceCall(a)})}toggleDevice(s){return _(this,null,function*(){if(this.useMockData){const{updateMockDeviceState:n,mockStates:a}=yield Ee(()=>_(this,null,function*(){const{updateMockDeviceState:p,mockStates:C}=yield import("./index-CkcIAYgn.js").then(h=>h.m);return{updateMockDeviceState:p,mockStates:C}}),__vite__mapDeps([0,1,2,3,4])),m=a.find(p=>p.entity_id===s);if(m){const p=m.state==="on"?"off":"on";n(s,p)}return}return s.split(".")[0],yield Ce.toggleDevice(this.baseUrl,this.token,s)})}activateScene(s){return _(this,null,function*(){if(this.useMockData){console.log(`Mock: Activating scene ${s}`);return}return yield Ce.activateScene(this.baseUrl,this.token,s)})}getConnectionStatus(){return{isConnected:this.isConnected,useMockData:this.useMockData,baseUrl:this.baseUrl,hasToken:!!this.token}}}const W=new Xt,Me=!1;function je(t,s=!0){const[n,a]=i.useState(null),[m,p]=i.useState(s),[C,h]=i.useState(null),[E,P]=i.useState(Me),z=i.useCallback(()=>_(null,null,function*(){if(t)try{if(p(!0),h(null),console.log(`🔍 useHomeAssistantEntity: Fetching ${t}, USE_MOCK_DATA=${Me}`),!Me){const c=yield W.getEntityState(t);a(c),P(W.isConnected)}}catch(c){h(c),console.error(`Error fetching entity ${t}:`,c)}finally{p(!1)}}),[t]);i.useEffect(()=>{if(!t||!s)return;let c;return _(null,null,function*(){try{Me||(yield W.connect(),P(W.isConnected),c=W.subscribe(t,y=>{a(y),h(null)}),yield z())}catch(y){h(y),P(!1),console.error(`Error setting up subscription for ${t}:`,y)}}),()=>{c&&c()}},[t,s,z]);const D=i.useCallback(()=>_(null,null,function*(){if(t)try{yield W.toggleDevice(t)}catch(c){h(c),console.error(`Error toggling ${t}:`,c)}}),[t]),d=i.useCallback((...o)=>_(null,[...o],function*(c={}){if(t)try{const y=t.split(".")[0];y==="light"?yield W.turnOnLight(t,c):yield W.callService(y,"turn_on",J({entity_id:t},c))}catch(y){h(y),console.error(`Error turning on ${t}:`,y)}}),[t]),k=i.useCallback(()=>_(null,null,function*(){if(t)try{const c=t.split(".")[0];c==="light"?yield W.turnOffLight(t):yield W.callService(c,"turn_off",{entity_id:t})}catch(c){h(c),console.error(`Error turning off ${t}:`,c)}}),[t]),R=i.useCallback(c=>_(null,null,function*(){if(!(!t||!t.startsWith("light.")))try{yield W.setLightBrightness(t,c)}catch(o){h(o),console.error(`Error setting brightness for ${t}:`,o)}}),[t]),T=i.useCallback(c=>_(null,null,function*(){if(!(!t||!t.startsWith("light.")))try{yield W.setLightColor(t,c)}catch(o){h(o),console.error(`Error setting color for ${t}:`,o)}}),[t]),U=i.useCallback(c=>_(null,null,function*(){if(!(!t||!t.startsWith("climate.")))try{yield W.setTemperature(t,c)}catch(o){h(o),console.error(`Error setting temperature for ${t}:`,o)}}),[t]),M=i.useCallback(c=>_(null,null,function*(){if(!(!t||!t.startsWith("climate.")))try{yield W.setHvacMode(t,c)}catch(o){h(o),console.error(`Error setting HVAC mode for ${t}:`,o)}}),[t]),A=i.useCallback(c=>_(null,null,function*(){if(!(!t||!t.startsWith("media_player.")))try{yield W.setVolume(t,c)}catch(o){h(o),console.error(`Error setting volume for ${t}:`,o)}}),[t]),b=i.useCallback(()=>_(null,null,function*(){if(!(!t||!t.startsWith("media_player.")))try{yield W.mediaPlayPause(t)}catch(c){h(c),console.error(`Error play/pause for ${t}:`,c)}}),[t]),x=i.useCallback(()=>_(null,null,function*(){if(!(!t||!t.startsWith("scene.")))try{yield W.activateScene(t)}catch(c){h(c),console.error(`Error activating scene ${t}:`,c)}}),[t]),O=i.useCallback((y,...L)=>_(null,[y,...L],function*(c,o={}){if(t)try{const G=t.split(".")[0];yield W.callService(G,c,J({entity_id:t},o))}catch(G){h(G),console.error(`Error calling service ${c} for ${t}:`,G)}}),[t]);return{entity:n,loading:m,error:C,isConnected:E,toggle:D,turnOn:d,turnOff:k,callService:O,refresh:z,setBrightness:R,setColor:T,setTemperature:U,setHvacMode:M,setVolume:A,playPause:b,activate:x,connectionStatus:W.getConnectionStatus()}}function Yt({lightId:t,device:s,onToggle:n,onLongPress:a}){var j,w;const{entity:m,loading:p,error:C,toggle:h}=je(t,!!t),[E,P]=i.useState(!1),[z,D]=i.useState(null),[d,k]=i.useState(!1),[R,T]=i.useState(!1),[U,M]=i.useState(!1),[A,b]=i.useState({x:85,y:85}),x=i.useRef(null),O=i.useRef(null),c=m||s,o=(j=c==null?void 0:c.isOn)!=null?j:(c==null?void 0:c.state)==="on",y=(c==null?void 0:c.state)==="unavailable"||p,L=!!C;i.useEffect(()=>{o&&k(!0)},[o]),i.useEffect(()=>{const g=()=>{if(x.current&&O.current){const I=x.current.getBoundingClientRect(),Y=O.current.getBoundingClientRect(),N=Y.left+Y.width/2-I.left,B=Y.top+Y.height/2-I.top,H=N/I.width*100,re=B/I.height*100;b({x:H,y:re})}};return g(),window.addEventListener("resize",g),()=>window.removeEventListener("resize",g)},[]);const G=(c==null?void 0:c.name)||((w=c==null?void 0:c.attributes)==null?void 0:w.friendly_name)||(c==null?void 0:c.entity_id)||(c==null?void 0:c.id),q=(c==null?void 0:c.id)||(c==null?void 0:c.entity_id),X=()=>G?G.includes("Light")?G.replace(" Light",""):q?q.split(".")[1].split("_").map(I=>I.charAt(0).toUpperCase()+I.slice(1)).join(" "):"":"",V=()=>{if(!G)return"Light";const g=X();return G.replace(g,"").trim()||"Light"},K=()=>_(null,null,function*(){if(!y&&!R&&!L){T(!0);const g=o;M(!g),g||k(!0);try{t&&h?yield h():n&&q&&(yield n(q))}catch(I){console.error("Error toggling light:",I)}setTimeout(()=>{T(!1),g&&k(!1)},600)}}),l=()=>{if(y||L)return;P(!0);const g=setTimeout(()=>{a==null||a(q),P(!1)},500);D(g)},S=()=>{z&&(clearTimeout(z),D(null)),P(!1)},u=()=>L?"border-red-200 bg-red-50 opacity-75 cursor-not-allowed":y?"border-gray-200 bg-gray-100 opacity-50 cursor-not-allowed":o||d?"border-[#efb643] bg-yellow-50 shadow-sm":"border-[#efb643] bg-[#f8f9fa]",f=()=>L?"text-red-400":y?"text-gray-400":o?"text-yellow-500":"text-gray-500";return t&&p?e.jsxs("div",{className:"relative p-4 rounded-lg border h-full flex flex-col bg-gray-100 border-gray-200 animate-pulse",children:[e.jsx("div",{className:"flex items-center mb-3",children:e.jsx("div",{className:"w-6 h-6 bg-gray-300 rounded"})}),e.jsx("div",{className:"h-6 bg-gray-300 rounded mb-1 w-3/4"}),e.jsx("div",{className:"h-4 bg-gray-300 rounded w-1/2"}),e.jsx("div",{className:"absolute bottom-2 right-2",children:e.jsx("div",{className:"w-10 h-10 bg-gray-300 rounded-full"})})]}):e.jsxs("div",{ref:x,className:`relative p-4 rounded-lg border transition-all duration-200 cursor-pointer select-none h-full flex flex-col overflow-hidden ${u()} ${E?"scale-95":"active:scale-95"}`,onClick:K,onMouseDown:l,onMouseUp:S,onMouseLeave:S,onTouchStart:l,onTouchEnd:S,onTouchCancel:S,onContextMenu:g=>{g.preventDefault(),!y&&!L&&(a==null||a(q))},children:[d&&e.jsx("span",{className:"absolute inset-0 z-0",style:{backgroundColor:"#fef3cd",clipPath:R?void 0:"circle(150% at 50% 50%)",animation:R?`${U?"lightTurnOn":"lightTurnOff"} 600ms ease-in-out forwards`:void 0,"--button-x":`${A.x}%`,"--button-y":`${A.y}%`}}),e.jsxs("div",{className:"relative z-10",children:[e.jsx("div",{className:"flex items-center mb-3",children:e.jsx(ze,{className:`w-6 h-6 ${f()} ${o?"fill-current":""}`})}),e.jsx("h3",{className:"font-semibold text-base text-gray-800 truncate mb-1",children:V()||"Light"}),e.jsx("p",{className:"text-sm text-gray-600 truncate",children:X()}),e.jsx("div",{className:"absolute bottom-2 right-2",children:e.jsx("div",{ref:O,className:`w-10 h-10 rounded-full flex items-center justify-center transition-all duration-200 ${y?"bg-gray-200 text-gray-400":"bg-[#efb643] text-white shadow-sm"}`,children:e.jsx(Pe,{className:"w-4 h-4"})})})]})]})}function es({switchId:t,device:s,onToggle:n}){var S,u;const{entity:a,loading:m,error:p,toggle:C}=je(t,!!t),[h,E]=i.useState(!1),[P,z]=i.useState(!1),[D,d]=i.useState(!1),[k,R]=i.useState(!1),[T,U]=i.useState({x:85,y:85}),M=i.useRef(null),A=i.useRef(null),b=a||s,x=(S=b==null?void 0:b.isOn)!=null?S:(b==null?void 0:b.state)==="on",O=(b==null?void 0:b.state)==="unavailable"||m,c=!!p,o=(b==null?void 0:b.id)||(b==null?void 0:b.entity_id);i.useEffect(()=>{x&&z(!0)},[x]),i.useEffect(()=>{const f=()=>{if(M.current&&A.current){const j=M.current.getBoundingClientRect(),w=A.current.getBoundingClientRect(),g=w.left+w.width/2-j.left,I=w.top+w.height/2-j.top,Y=g/j.width*100,N=I/j.height*100;U({x:Y,y:N})}};return f(),window.addEventListener("resize",f),()=>window.removeEventListener("resize",f)},[]);const y=(b==null?void 0:b.name)||((u=b==null?void 0:b.attributes)==null?void 0:u.friendly_name)||(b==null?void 0:b.entity_id)||(b==null?void 0:b.id),L=()=>{if(y.toLowerCase().includes("porch"))return"Porch";if(y.toLowerCase().includes("kitchen")||y.toLowerCase().includes("coffee"))return"Kitchen";if(y.toLowerCase().includes("living"))return"Living Room";if(y.toLowerCase().includes("bedroom"))return"Bedroom";if(!o)return"General";const f=o.split(".")[1];if(f.includes("_")){const j=f.split("_");for(const w of j)if(["porch","kitchen","living","bedroom","garage","basement"].includes(w))return w.charAt(0).toUpperCase()+w.slice(1)}return"General"},G=()=>y||"Switch",q=()=>_(null,null,function*(){if(!O&&!D&&!c){d(!0);const f=x;R(!f),f||z(!0);try{t&&C?yield C():n&&o&&(yield n(o))}catch(j){console.error("Error toggling switch:",j)}setTimeout(()=>{d(!1),f&&z(!1)},600)}}),X=()=>{!O&&!c&&E(!0)},V=()=>{E(!1)},K=()=>c?"border-red-200 bg-red-50 opacity-75 cursor-not-allowed":O?"border-gray-200 bg-gray-100 opacity-50 cursor-not-allowed":x||P?"border-[#8b5a9b] bg-purple-50 shadow-sm":"border-[#8b5a9b] bg-[#f8f9fa]",l=()=>c?"text-red-400":O?"text-gray-400":x?"text-purple-600":"text-gray-500";return t&&m?e.jsxs("div",{className:"relative p-4 rounded-lg border h-full flex flex-col bg-gray-100 border-gray-200 animate-pulse",children:[e.jsx("div",{className:"flex items-center mb-3",children:e.jsx("div",{className:"w-6 h-6 bg-gray-300 rounded"})}),e.jsx("div",{className:"h-6 bg-gray-300 rounded mb-1 w-3/4"}),e.jsx("div",{className:"h-4 bg-gray-300 rounded w-1/2"}),e.jsx("div",{className:"absolute bottom-2 right-2",children:e.jsx("div",{className:"w-10 h-10 bg-gray-300 rounded-full"})})]}):t&&c?e.jsxs("div",{className:"relative p-4 rounded-lg border h-full flex flex-col bg-red-50 border-red-200",children:[e.jsx("div",{className:"flex items-center mb-3",children:e.jsx(Re,{className:"w-6 h-6 text-red-400"})}),e.jsx("h3",{className:"font-semibold text-base text-red-800 truncate mb-1",children:"Switch Error"}),e.jsx("p",{className:"text-sm text-red-600 truncate",children:p}),e.jsx("div",{className:"absolute bottom-2 right-2",children:e.jsx("div",{className:"w-10 h-10 bg-red-200 text-red-400 rounded-full flex items-center justify-center",children:e.jsx(Pe,{className:"w-4 h-4"})})})]}):e.jsxs("div",{ref:M,className:`relative p-4 rounded-lg border transition-all duration-200 cursor-pointer select-none h-full flex flex-col overflow-hidden ${K()} ${h?"scale-95":"active:scale-95"}`,onClick:q,onMouseDown:X,onMouseUp:V,onMouseLeave:V,onTouchStart:X,onTouchEnd:V,onTouchCancel:V,children:[P&&e.jsx("span",{className:"absolute inset-0 z-0",style:{backgroundColor:"#e6d6ea",clipPath:D?void 0:"circle(150% at 50% 50%)",animation:D?`${k?"switchTurnOn":"switchTurnOff"} 600ms ease-in-out forwards`:void 0,"--button-x":`${T.x}%`,"--button-y":`${T.y}%`}}),e.jsxs("div",{className:"relative z-10",children:[e.jsx("div",{className:"flex items-center mb-3",children:x?e.jsx(It,{className:`w-6 h-6 ${l()}`}):e.jsx(Re,{className:`w-6 h-6 ${l()}`})}),e.jsx("h3",{className:"font-semibold text-base text-gray-800 truncate mb-1",children:G()}),e.jsx("p",{className:"text-sm text-gray-600 truncate",children:L()}),e.jsx("div",{className:"absolute bottom-2 right-2",children:e.jsx("div",{ref:A,className:`w-10 h-10 rounded-full flex items-center justify-center transition-all duration-200 ${O?"bg-gray-200 text-gray-400":"bg-[#8b5a9b] text-white shadow-sm"}`,children:e.jsx(Pe,{className:"w-4 h-4"})})})]})]})}function ts({lightId:t,device:s,isVisible:n=!1,onClose:a,onUpdateLight:m}){var l,S;const{entity:p,loading:C,error:h,setBrightness:E,setColor:P}=je(t,!!t&&n),[z,D]=i.useState(255),[d,k]=i.useState(100),[R,T]=i.useState("#ffffff"),[U,M]=i.useState(!1),[A,b]=i.useState(!1),x=p||s,O=(x==null?void 0:x.name)||((l=x==null?void 0:x.attributes)==null?void 0:l.friendly_name)||(x==null?void 0:x.entity_id)||(x==null?void 0:x.id)||"Light",c=(S=x==null?void 0:x.isOn)!=null?S:(x==null?void 0:x.state)==="on",o=(x==null?void 0:x.id)||(x==null?void 0:x.entity_id),y=u=>{if(!u||!Array.isArray(u)||u.length!==3)return"#ffffff";const[f,j,w]=u;return`#${((1<<24)+(f<<16)+(j<<8)+w).toString(16).slice(1)}`},L=u=>{const f=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(u);return f?[parseInt(f[1],16),parseInt(f[2],16),parseInt(f[3],16)]:[255,255,255]};i.useEffect(()=>{var u,f;if(x&&n){const j=x.brightness||((u=x.attributes)==null?void 0:u.brightness)||255,w=x.brightnessPercent||Math.round(j/255*100);D(j),k(w);const g=x.rgbColor||((f=x.attributes)==null?void 0:f.rgb_color);T(y(g)),M(!1)}},[x,n]);const G=u=>{D(u),k(Math.round(u/255*100)),M(!0)},q=u=>{T(u),M(!0)},X=()=>_(null,null,function*(){if(!(!U||A)){b(!0);try{if(t&&(E||P))E&&(yield E(d)),P&&(yield P(L(R)));else if(m&&o){const u={brightness:parseInt(z),rgb_color:L(R)};yield m(o,u)}M(!1),a==null||a()}catch(u){console.error("Error saving light configuration:",u)}finally{b(!1)}}}),V=()=>{var u,f;if(x){const j=x.brightness||((u=x.attributes)==null?void 0:u.brightness)||255,w=x.brightnessPercent||Math.round(j/255*100),g=x.rgbColor||((f=x.attributes)==null?void 0:f.rgb_color);D(j),k(w),T(y(g))}M(!1),b(!1),a==null||a()},K=u=>{u.target===u.currentTarget&&V()};return t&&C&&n?e.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm z-50 flex items-center justify-center p-4",children:e.jsx("div",{className:"bg-white rounded-2xl shadow-2xl max-w-md w-full p-8",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-500 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-600",children:"Loading light configuration..."})]})})}):t&&h&&n?e.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm z-50 flex items-center justify-center p-4",children:e.jsx("div",{className:"bg-white rounded-2xl shadow-2xl max-w-md w-full p-8",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-red-500 mb-4",children:e.jsx(we,{className:"w-8 h-8 mx-auto"})}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Error Loading Light"}),e.jsx("p",{className:"text-gray-600 mb-4",children:h}),e.jsx("button",{onClick:a,className:"px-4 py-2 bg-gray-200 text-gray-800 rounded-lg hover:bg-gray-300 transition-colors",children:"Close"})]})})}):!n||!x?null:e.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm z-50 flex items-center justify-center p-4",onClick:K,children:e.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl max-w-md w-full max-h-[90vh] overflow-hidden",children:[e.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:`p-2 rounded-lg ${c?"bg-yellow-100":"bg-gray-100"}`,children:e.jsx(ze,{className:`w-6 h-6 ${c?"text-yellow-600 fill-current":"text-gray-500"}`})}),e.jsxs("div",{children:[e.jsx("h2",{className:"font-semibold text-lg text-gray-900",children:O}),e.jsx("p",{className:"text-sm text-gray-600",children:"Light Configuration"})]})]}),e.jsx("button",{onClick:V,className:"p-2 text-gray-400 rounded-lg transition-colors",children:e.jsx(we,{className:"w-6 h-6"})})]}),e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsx("div",{className:"text-center",children:e.jsxs("div",{className:`inline-flex items-center gap-2 px-3 py-2 rounded-full text-sm font-medium ${c?"bg-green-100 text-green-800":"bg-gray-100 text-gray-800"}`,children:[e.jsx("div",{className:`w-2 h-2 rounded-full ${c?"bg-green-500":"bg-gray-400"}`}),c?"Currently On":"Currently Off"]})}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Bt,{className:"w-5 h-5 text-gray-600"}),e.jsx("h3",{className:"font-medium text-gray-900",children:"Brightness"}),e.jsxs("span",{className:"text-sm text-gray-600 ml-auto",children:[d,"%"]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("input",{type:"range",min:"1",max:"255",value:z,onChange:u=>G(parseInt(u.target.value)),className:"w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer",style:{background:`linear-gradient(to right, #fbbf24 0%, #fbbf24 ${z/255*100}%, #e5e7eb ${z/255*100}%, #e5e7eb 100%)`}}),e.jsxs("div",{className:"flex justify-between text-xs text-gray-500",children:[e.jsx("span",{children:"Dim"}),e.jsx("span",{children:"Bright"})]})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Ct,{className:"w-5 h-5 text-gray-600"}),e.jsx("h3",{className:"font-medium text-gray-900",children:"Color"})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("input",{type:"color",value:R,onChange:u=>q(u.target.value),className:"w-12 h-12 border-2 border-gray-300 rounded-lg cursor-pointer"}),e.jsx("div",{className:"flex-1",children:e.jsx("input",{type:"text",value:R.toUpperCase(),onChange:u=>q(u.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg font-mono text-sm",placeholder:"#FFFFFF"})})]}),e.jsx("div",{className:"grid grid-cols-6 gap-2",children:["#ffffff","#fbbf24","#f59e0b","#ef4444","#22c55e","#3b82f6"].map(u=>e.jsx("button",{onClick:()=>q(u),className:`w-8 h-8 rounded-lg border-2 transition-all ${R.toLowerCase()===u?"border-gray-800 scale-110":"border-gray-300"}`,style:{backgroundColor:u}},u))})]})]})]}),e.jsxs("div",{className:"flex items-center justify-between p-6 border-t border-gray-200 bg-gray-50",children:[e.jsx("button",{onClick:V,className:"px-4 py-2 text-gray-600 rounded-lg transition-colors",children:"Cancel"}),e.jsx("button",{onClick:X,disabled:!U||A,className:`px-6 py-2 rounded-lg font-medium transition-all ${U&&!A?"bg-blue-600 text-white shadow-sm":"bg-gray-300 text-gray-500 cursor-not-allowed"}`,children:A?"Saving...":U?"Save Changes":"No Changes"})]})]})})}const ss=["light","switch","cover","lock","fan","binary_sensor"],as=t=>{switch(t){case"light":return e.jsx(ze,{className:"w-5 h-5"});case"switch":return e.jsx(Re,{className:"w-5 h-5"});case"cover":return e.jsx(ve,{className:"w-5 h-5"});case"lock":return e.jsx(Ve,{className:"w-5 h-5"});case"fan":return e.jsx(Kt,{className:"w-5 h-5"});case"binary_sensor":return e.jsx(Qt,{className:"w-5 h-5"});default:return e.jsx(ve,{className:"w-5 h-5"})}},rs=t=>{switch(t){case"light":return"bg-yellow-100 text-yellow-700";case"switch":return"bg-blue-100 text-blue-700";case"cover":return"bg-green-100 text-green-700";case"lock":return"bg-red-100 text-red-700";case"fan":return"bg-purple-100 text-purple-700";case"binary_sensor":return"bg-gray-100 text-gray-700";default:return"bg-gray-100 text-gray-700"}};function ns({isOpen:t,onClose:s,selectedDevices:n=[],onDevicesChange:a,availableDevices:m}){const[p,C]=i.useState([]),[h,E]=i.useState(new Set(n.map(o=>o.id||o.entity_id))),[P,z]=i.useState(!0),[D,d]=i.useState(null),[k,R]=i.useState("all"),[T,U]=i.useState("");i.useEffect(()=>{t&&E(new Set(n.map(o=>o.id||o.entity_id)))},[t]),i.useEffect(()=>{if(!t)return;if(m&&m.length>0){console.log("🔧 DevicesSelectorModal: Using provided devices:",m),C(m),z(!1),d(null);return}console.log("🔧 DevicesSelectorModal: No provided devices, attempting to fetch..."),_(null,null,function*(){try{z(!0),d(null);const L=(yield W.getStates()).filter(G=>ss.includes(G.type)&&!G.id.includes("_battery")&&!G.id.includes("_signal_strength"));C(L)}catch(y){d(y.message),console.error("Error fetching devices:",y)}finally{z(!1)}})},[t,m]);const M=o=>{const y=new Set(h);y.has(o)?y.delete(o):y.add(o),E(y)},A=()=>{const o=p.filter(y=>h.has(y.id));a(o),s()},b=()=>{E(new Set(n.map(o=>o.id||o.entity_id))),s()},x=p.filter(o=>{const y=k==="all"||o.type===k,L=T===""||o.name.toLowerCase().includes(T.toLowerCase())||o.id.toLowerCase().includes(T.toLowerCase());return y&&L}),O=x.reduce((o,y)=>(o[y.type]||(o[y.type]=[]),o[y.type].push(y),o),{}),c=[...new Set(p.map(o=>o.type))];return t?e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-2xl mx-4 max-h-[80vh] flex flex-col",children:[e.jsx("h2",{className:"text-xl font-semibold mb-4 text-gray-900",children:"Select Devices"}),e.jsxs("div",{className:"flex space-x-4 mb-4",children:[e.jsx("div",{className:"flex-1",children:e.jsx("input",{type:"text",placeholder:"Search devices...",value:T,onChange:o=>U(o.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})}),e.jsx("div",{children:e.jsxs("select",{value:k,onChange:o=>R(o.target.value),className:"px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[e.jsx("option",{value:"all",children:"All Types"}),c.map(o=>e.jsxs("option",{value:o,children:[o.charAt(0).toUpperCase()+o.slice(1),"s"]},o))]})})]}),P&&e.jsx("div",{className:"flex items-center justify-center py-8",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-500"})}),D&&e.jsxs("div",{className:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded mb-4",children:["Error loading devices: ",D]}),!P&&!D&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"flex-1 overflow-y-auto mb-4",children:x.length===0?e.jsx("p",{className:"text-gray-500 text-center py-8",children:T||k!=="all"?"No devices match your filters":"No devices available"}):e.jsx("div",{className:"space-y-4",children:Object.entries(O).map(([o,y])=>e.jsxs("div",{className:"space-y-2",children:[e.jsxs("h3",{className:"text-sm font-medium text-gray-700 uppercase tracking-wider",children:[o,"s (",y.length,")"]}),e.jsx("div",{className:"space-y-2",children:y.map(L=>{var G,q,X,V,K;return e.jsxs("label",{className:"flex items-center p-3 border rounded-lg hover:bg-gray-50 cursor-pointer transition-colors",children:[e.jsx("input",{type:"checkbox",checked:h.has(L.id),onChange:()=>M(L.id),className:"h-4 w-4 text-blue-600 rounded border-gray-300 mr-3"}),e.jsx("div",{className:`flex items-center justify-center w-10 h-10 rounded-lg mr-3 ${rs(L.type)}`,children:as(L.type)}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("div",{className:"font-medium text-gray-900 truncate",children:L.name}),e.jsx("div",{className:"flex items-center space-x-2",children:(L.state||((G=L.raw)==null?void 0:G.state))&&e.jsx("span",{className:`inline-flex items-center px-2 py-0.5 rounded-full text-xs font-medium ${L.state==="on"||((q=L.raw)==null?void 0:q.state)==="on"||L.state==="open"||((X=L.raw)==null?void 0:X.state)==="open"?"bg-green-100 text-green-800":L.state==="unavailable"||((V=L.raw)==null?void 0:V.state)==="unavailable"?"bg-red-100 text-red-800":"bg-gray-100 text-gray-800"}`,children:L.state||((K=L.raw)==null?void 0:K.state)})})]})]},L.id)})})]},o))})}),e.jsxs("div",{className:"border-t pt-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsxs("span",{className:"text-sm text-gray-600",children:[h.size," device",h.size!==1?"s":""," selected"]}),e.jsx("div",{className:"flex space-x-2",children:h.size>0&&e.jsx("button",{onClick:()=>E(new Set),className:"text-sm text-blue-600 hover:text-blue-700",children:"Clear All"})})]}),e.jsxs("div",{className:"flex space-x-3",children:[e.jsx("button",{onClick:b,className:"flex-1 py-2 px-4 bg-gray-200 text-gray-800 rounded-lg hover:bg-gray-300 transition-colors",children:"Cancel"}),e.jsxs("button",{onClick:A,disabled:h.size===0,className:"flex-1 py-2 px-4 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:bg-gray-300 disabled:cursor-not-allowed transition-colors",children:["Update (",h.size,")"]})]})]})]})]})}):null}function is({isOpen:t,onClose:s,selectedScenes:n=[],onScenesChange:a,availableScenes:m=[]}){const[p,C]=i.useState(new Set(n.map(d=>d.id))),[h]=i.useState(!1),[E]=i.useState(null);i.useEffect(()=>{t&&C(new Set(n.map(d=>d.id)))},[t]);const P=d=>{const k=new Set(p);k.has(d)?k.delete(d):k.add(d),C(k)},z=()=>{const d=m.filter(k=>p.has(k.id));a(d),s()},D=()=>{C(new Set(n.map(d=>d.id))),s()};return t?e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-md mx-4 max-h-96 flex flex-col",children:[e.jsx("h2",{className:"text-xl font-semibold mb-4 text-gray-900",children:"Select Scenes"}),h&&e.jsx("div",{className:"flex items-center justify-center py-8",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-500"})}),E&&e.jsxs("div",{className:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded mb-4",children:["Error loading scenes: ",E]}),!h&&!E&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"flex-1 overflow-y-auto mb-4",children:m.length===0?e.jsx("p",{className:"text-gray-500 text-center py-4",children:"No scenes available"}):e.jsx("div",{className:"space-y-2",children:m.map(d=>e.jsxs("label",{className:"flex items-center p-3 border rounded-lg hover:bg-gray-50 cursor-pointer transition-colors",children:[e.jsx("input",{type:"checkbox",checked:p.has(d.id),onChange:()=>P(d.id),className:"h-4 w-4 text-blue-600 rounded border-gray-300 mr-3"}),e.jsx("div",{className:"flex-1",children:e.jsxs("div",{className:"flex items-center",children:[d.icon&&e.jsx("span",{className:"text-lg mr-2",children:d.icon}),e.jsx("span",{className:"font-medium text-gray-900",children:d.name})]})})]},d.id))})}),e.jsxs("div",{className:"flex space-x-3",children:[e.jsx("button",{onClick:D,className:"flex-1 py-2 px-4 bg-gray-200 text-gray-800 rounded-lg hover:bg-gray-300 transition-colors",children:"Cancel"}),e.jsxs("button",{onClick:z,disabled:p.size===0,className:"flex-1 py-2 px-4 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:bg-gray-300 disabled:cursor-not-allowed transition-colors",children:["Update (",p.size,")"]})]})]})]})}):null}const ls=`
  @keyframes rippleFill {
    0% {
      clip-path: circle(0px at 88% 85%);
    }
    100% {
      clip-path: circle(200px at 88% 85%);
    }
  }

  .animate-ripple {
    background-color: rgb(105, 165, 209);
    animation: rippleFill 300ms ease-out forwards,
      fadeOut 300ms ease-in 2s forwards;
  }

  @keyframes fadeOut {
    from {
      opacity: 1;
    }
    to {
      opacity: 0;
    }
  }
`;if(typeof document!="undefined"){const t=document.getElementById("scene-card-animations-v2");t&&t.remove();const s=document.createElement("style");s.id="scene-card-animations-v2",s.textContent=ls,document.head.appendChild(s)}function os({sceneId:t,scene:s,onActivate:n}){var c;const{entity:a,loading:m,error:p,activate:C}=je(t,!!t),[h,E]=i.useState(!1),[P,z]=i.useState(!1),[D,d]=i.useState(!1),[k,R]=i.useState(!1),T=a||s,U=(T==null?void 0:T.name)||((c=T==null?void 0:T.attributes)==null?void 0:c.friendly_name)||(T==null?void 0:T.entity_id)||"Unknown Scene",M=(T==null?void 0:T.state)==="unavailable"||m,A=!!p,b=()=>_(null,null,function*(){if(!(M||h||A)){E(!0),d(!0),R(!0);try{t&&C?yield C():n&&T&&(yield n(T.entity_id||T.id)),setTimeout(()=>{d(!1)},2300),setTimeout(()=>{R(!1),E(!1)},2600)}catch(o){console.error("Failed to activate scene:",o),d(!1),R(!1),E(!1)}}}),x=()=>h&&!D?e.jsx("div",{className:"w-6 h-6 animate-spin rounded-full border-2 border-blue-600 border-t-transparent"}):e.jsx(We,{className:"w-6 h-6"}),O=()=>A?"text-red-400 bg-red-100 border-red-200":M?"text-gray-400 bg-gray-100 border-gray-200":"text-black";return t&&m?e.jsxs("div",{className:"relative p-4 rounded-lg border h-[120px] bg-gray-100 border-gray-200 animate-pulse",children:[e.jsx("div",{className:"flex items-center mb-3",children:e.jsx("div",{className:"w-6 h-6 bg-gray-300 rounded"})}),e.jsx("div",{className:"h-6 bg-gray-300 rounded mb-2 w-3/4"}),e.jsx("div",{className:"h-4 bg-gray-300 rounded w-1/2"})]}):t&&A?e.jsxs("div",{className:"relative p-4 rounded-lg border h-[120px] bg-red-50 border-red-200",children:[e.jsx("div",{className:"flex items-center mb-3",children:e.jsx("div",{className:"text-red-400",children:e.jsx(We,{className:"w-6 h-6"})})}),e.jsx("h3",{className:"font-semibold text-xl truncate mb-2 text-red-800",children:"Scene Error"}),e.jsx("p",{className:"text-xs text-red-600",children:p})]}):e.jsxs("div",{className:`relative p-4 rounded-lg border transition-all duration-200 cursor-pointer select-none h-[120px] overflow-hidden ${M?"opacity-50 cursor-not-allowed":"active:scale-95"} ${O()} ${P?"scale-95":""}`,style:{backgroundColor:M?void 0:"#f8f9fa",borderColor:M?void 0:"rgb(105, 165, 209)"},onClick:b,onMouseDown:()=>z(!0),onMouseUp:()=>z(!1),onMouseLeave:()=>z(!1),onTouchStart:()=>z(!0),onTouchEnd:()=>z(!1),children:[D&&e.jsx("span",{className:"absolute inset-0 z-0",style:{backgroundColor:"rgb(105, 165, 209)",clipPath:"circle(0px at 88% 85%)",animation:"rippleFillNew 300ms ease-out forwards, fadeOutNew 300ms ease-in 2s forwards"}}),e.jsxs("div",{className:"relative z-10",children:[e.jsx("div",{className:"flex items-center mb-3",children:e.jsx("div",{className:M?void 0:"text-black",children:x()})}),e.jsx("h3",{className:`font-semibold text-xl truncate mb-2 ${M?"text-gray-800":"text-black"}`,children:U}),e.jsx("p",{className:`text-xs ${A?"text-red-400":M?"text-gray-400":h?"text-blue-700":"text-black opacity-75"}`,children:A?"Error loading scene":M?m?"Loading...":"Unavailable":h?"Activating...":"Tap to activate"}),e.jsx("div",{className:"absolute bottom-2 right-2 z-20",children:e.jsx("div",{className:`w-12 h-12 rounded-full flex items-center justify-center transition-all duration-200 ${M?"bg-gray-200":""}`,style:{backgroundColor:M?void 0:"rgb(105, 165, 209)"},children:e.jsx(De,{className:`w-5 h-5 ml-0.5 ${M?"text-current":"text-black"}`})})})]})]})}function cs({spotifyData:t={},onPlay:s,onPause:n,onNext:a,onPrevious:m,onVolumeChange:p,onToggleLike:C,onDeviceChange:h,availableDevices:E=[]}){var pe;const[P,z]=i.useState(t.volume||50),[D,d]=i.useState(!1),[k,R]=i.useState(!1),[T,U]=i.useState(null),[M,A]=i.useState(null),[b,x]=i.useState(new Set),[O,c]=i.useState({}),[o,y]=i.useState(!1),[L,G]=i.useState(""),q=i.useRef(null),{isPlaying:X=!1,currentTrack:V=null,album:K=null,artist:l=null,isConnected:S=!1,isLiked:u=!1,duration:f=0,position:j=0,activeDevice:w=null}=t,g=E.length>0?E:[{id:"living_room_sonos",name:"Living Room",type:"One SL",isOnline:!0,isInGroup:!0,isGroupCoordinator:!0,volume:65,groupId:"group_1"},{id:"kitchen_sonos",name:"Kitchen",type:"Play:1",isOnline:!0,isInGroup:!0,isGroupCoordinator:!1,volume:50,groupId:"group_1"},{id:"bedroom_sonos",name:"Bedroom",type:"One",isOnline:!0,isInGroup:!0,isGroupCoordinator:!0,volume:30,groupId:"group_2"},{id:"bathroom_sonos",name:"Bathroom",type:"One SL",isOnline:!0,isInGroup:!0,isGroupCoordinator:!1,volume:40,groupId:"group_2"},{id:"office_sonos",name:"Office",type:"Play:5",isOnline:!1,isInGroup:!1,isGroupCoordinator:!1,volume:0,groupId:null},{id:"dining_sonos",name:"Dining Room",type:"Play:3",isOnline:!0,isInGroup:!1,isGroupCoordinator:!1,volume:35,groupId:null},{id:"patio_sonos",name:"Patio",type:"Move",isOnline:!0,isInGroup:!1,isGroupCoordinator:!1,volume:70,groupId:null}],I={source:"Spotify",track:"Bohemian Rhapsody",artist:"Queen"},N=[...new Set(g.filter(r=>r.groupId).map(r=>r.groupId))].map(r=>{const v=g.filter(se=>se.groupId===r),$=v.find(se=>se.isGroupCoordinator);return{id:r,name:`${($==null?void 0:$.name)||"Unknown"} + ${v.length-1}`,coordinator:$,members:v.filter(se=>!se.isGroupCoordinator),allDevices:v}}),B=g.filter(r=>!r.groupId&&r.isOnline);i.useEffect(()=>{!M&&N.length>0&&A(N[0].id)},[N.length,M]);const H=M?N.find(r=>r.id===M):null,re=H==null?void 0:H.coordinator,Q=H?g.filter(r=>b.has(r.id)):[],te=g.filter(r=>!b.has(r.id)&&r.isOnline),le=()=>{const r=H?new Set(H.allDevices.map($=>$.id)):new Set;x(r);const v={};g.forEach($=>{v[$.id]=$.volume}),c(v)};i.useEffect(()=>{const r=v=>{v.key==="Escape"&&R(!1)};if(k)return document.addEventListener("keydown",r),()=>document.removeEventListener("keydown",r)},[k]);const ae=r=>{z(r),p==null||p(r)},ie=r=>{const v=new Set(b);v.has(r)?v.delete(r):v.add(r),x(v)},de=(r,v)=>{c($=>ee(J({},$),{[r]:v}))},Ne=()=>{const r=g.filter(ge=>b.has(ge.id)),v=(H==null?void 0:H.allDevices.length)||0,$=r.length;let se="";if($===0)se="All devices ungrouped";else if($===1)se=`${r[0].name} playing solo`;else if(v!==$){const ge=r.slice(0,2).map(oe=>oe.name).join(" and "),Z=$-2;se=Z>0?`${ge} and ${Z} other${Z>1?"s":""} grouped`:`${ge} grouped`}else se="Group updated";G(se),y(!0),R(!1),setTimeout(()=>y(!1),3e3),h==null||h(r,O)},_e=()=>{le(),R(!0)},fe=r=>{const v=Math.floor(r/6e4),$=Math.floor(r%6e4/1e3);return`${v}:${$.toString().padStart(2,"0")}`},ke=f>0?j/f*100:0;if(!S)return e.jsx("div",{className:"bg-gradient-to-br from-green-50 to-green-100 rounded-lg p-4 border-2 border-green-200 h-full flex flex-col",children:e.jsx("div",{className:"flex items-center justify-center flex-1",children:e.jsxs("div",{className:"text-center",children:[e.jsx(ce,{className:"w-8 h-8 text-green-600 mx-auto mb-2"}),e.jsx("p",{className:"text-sm text-green-700 font-medium",children:"Spotify"}),e.jsx("p",{className:"text-xs text-green-600",children:"Not connected"})]})})});const Se=K!=null&&K.imageUrl&&K.imageUrl!=="https://upload.wikimedia.org/wikipedia/commons/1/16/Blank_album.jpg"?K.imageUrl:"https://www.ultimatequeen.co.uk/queen/gallery/albums-1/a-night-at-the-opera-uklpfront.jpg";return e.jsxs("div",{className:"rounded-lg h-full flex flex-col overflow-hidden relative",style:{backgroundImage:`url(${Se})`,backgroundSize:"cover",backgroundPosition:"center",backgroundRepeat:"no-repeat"},children:[e.jsx("div",{className:"absolute inset-0 bg-black/75 rounded-lg"}),o&&e.jsxs("div",{className:"absolute top-4 left-1/2 transform -translate-x-1/2 z-30 bg-green-600 text-white px-4 py-2 rounded-lg shadow-lg flex items-center gap-2 animate-pulse",children:[e.jsx(He,{className:"w-4 h-4"}),e.jsx("span",{className:"text-sm font-medium",children:L})]}),e.jsxs("div",{className:"relative z-10 p-4 h-full flex flex-col",children:[e.jsxs("div",{className:"flex-1 flex justify-between items-start",children:[e.jsxs("div",{className:"relative",ref:q,children:[e.jsxs("button",{onClick:_e,className:"flex items-center gap-2 px-3 py-2 rounded-lg transition-colors hover:bg-white/20 backdrop-blur-sm",children:[H?e.jsx(he,{className:"w-4 h-4"}):e.jsx(ve,{className:"w-4 h-4"}),e.jsx("span",{className:"text-sm text-white/90 font-medium drop-shadow max-w-24 truncate",children:H?H.name:((pe=B[0])==null?void 0:pe.name)||"No Device"}),e.jsx(Le,{className:`w-3 h-3 text-white/70 transition-transform ${k?"rotate-180":""}`})]}),k&&e.jsx("div",{className:"fixed inset-0 bg-black/60 backdrop-blur-sm z-50 flex items-center justify-center p-4",onClick:()=>R(!1),children:e.jsxs("div",{className:"bg-black/95 backdrop-blur-xl rounded-xl border border-white/20 shadow-2xl w-full max-w-2xl max-h-[90vh] overflow-hidden",onClick:r=>r.stopPropagation(),children:[e.jsxs("div",{className:"px-6 py-4 border-b border-white/20 flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-white/95 font-semibold text-lg",children:"Device Grouping"}),e.jsxs("p",{className:"text-white/70 text-sm mt-1",children:[b.size," device",b.size!==1?"s":""," selected",re&&` • ${re.name} (${re.type}) is coordinating`]})]}),e.jsx("button",{onClick:()=>R(!1),className:"p-2 text-white/60 hover:text-white/90 hover:bg-white/10 rounded-lg transition-colors",children:e.jsx(we,{className:"w-5 h-5"})})]}),(N.length>1||B.length>0)&&e.jsxs("div",{className:"px-6 py-4 border-b border-white/10",children:[e.jsx("h4",{className:"text-white/80 text-sm font-semibold mb-3",children:"SELECT GROUP TO CONTROL"}),e.jsxs("div",{className:"flex gap-2 flex-wrap",children:[N.map(r=>e.jsxs("button",{onClick:()=>{A(r.id),setTimeout(()=>le(),0)},className:`px-3 py-2 rounded-lg text-sm font-medium transition-colors flex items-center gap-2 ${M===r.id?"bg-blue-600 text-white":"bg-white/10 text-white/80 hover:bg-white/15 hover:text-white"}`,children:[e.jsx(he,{className:"w-4 h-4"}),r.name]},r.id)),B.length>0&&e.jsxs("button",{onClick:()=>{A(null),setTimeout(()=>le(),0)},className:`px-3 py-2 rounded-lg text-sm font-medium transition-colors flex items-center gap-2 ${M?"bg-white/10 text-white/80 hover:bg-white/15 hover:text-white":"bg-blue-600 text-white"}`,children:[e.jsx(ve,{className:"w-4 h-4"}),"Individual Devices"]})]})]}),e.jsxs("div",{className:"flex-1 overflow-y-auto max-h-[60vh] p-6",children:[Q.length>0&&e.jsxs("div",{className:"mb-8",children:[e.jsxs("h4",{className:"text-white/80 text-sm font-semibold mb-4 flex items-center gap-3",children:[e.jsx(he,{className:"w-4 h-4"}),"CURRENT GROUP"]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:Q.map(r=>{const v=O[r.id]||r.volume;return e.jsxs("div",{className:"p-4 bg-white/8 rounded-xl border border-white/15 hover:bg-white/10 transition-colors",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[e.jsx("button",{onClick:()=>ie(r.id),className:"w-6 h-6 rounded-lg border-2 bg-green-500 border-green-500 flex items-center justify-center hover:bg-green-600 transition-colors",children:e.jsx(ot,{className:"w-4 h-4 text-white"})}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("span",{className:"text-white/95 font-semibold text-base",children:r.name}),r.isGroupCoordinator&&e.jsxs("div",{className:"flex items-center gap-1 px-2 py-1 bg-blue-500/20 rounded-full",children:[e.jsx(gt,{className:"w-4 h-4 text-blue-400"}),e.jsx("span",{className:"text-blue-400 text-sm font-medium",children:"Coordinator"})]})]}),e.jsx("p",{className:"text-white/60 text-sm",children:r.type}),r.isGroupCoordinator&&I&&e.jsxs("p",{className:"text-white/70 text-sm mt-1",children:[I.source," • ",I.track]})]}),e.jsx("button",{onClick:()=>ie(r.id),className:"p-2 text-white/50 hover:text-red-400 hover:bg-red-400/20 rounded-lg transition-colors",title:"Remove from group",children:e.jsx(Qe,{className:"w-4 h-4"})})]}),e.jsxs("div",{className:"flex items-center gap-3 mt-2",children:[e.jsx(be,{className:"w-4 h-4 text-white/50"}),e.jsx("input",{type:"range",min:"0",max:"100",value:v,onChange:$=>de(r.id,parseInt($.target.value)),className:"flex-1 h-2 bg-white/20 rounded-lg appearance-none cursor-pointer",style:{background:`linear-gradient(to right, #10b981 0%, #10b981 ${v}%, rgba(255,255,255,0.2) ${v}%, rgba(255,255,255,0.2) 100%)`}}),e.jsxs("span",{className:"text-sm text-white/70 w-12 text-right font-medium",children:[v,"%"]})]})]},r.id)})})]}),te.length>0&&e.jsxs("div",{className:"mb-8",children:[e.jsxs("h4",{className:"text-white/80 text-sm font-semibold mb-4 flex items-center gap-3",children:[e.jsx(ye,{className:"w-4 h-4"}),"AVAILABLE TO ADD"]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:te.map(r=>{const v=O[r.id]||r.volume;return e.jsxs("div",{className:"p-4 rounded-xl border border-white/10 hover:bg-white/5 hover:border-white/20 transition-colors cursor-pointer",onClick:()=>ie(r.id),children:[e.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[e.jsx("button",{onClick:$=>{$.stopPropagation(),ie(r.id)},className:"w-6 h-6 rounded-lg border-2 border-white/40 bg-transparent flex items-center justify-center hover:border-white/60 transition-colors"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"text-white/95 font-semibold text-base",children:r.name}),e.jsx("p",{className:"text-white/60 text-sm",children:r.type})]}),e.jsx("button",{onClick:$=>{$.stopPropagation(),ie(r.id)},className:"p-2 text-white/50 hover:text-green-400 hover:bg-green-400/20 rounded-lg transition-colors",title:"Add to group",children:e.jsx(ye,{className:"w-4 h-4"})})]}),e.jsxs("div",{className:"flex items-center gap-3 mt-2",children:[e.jsx(be,{className:"w-4 h-4 text-white/50"}),e.jsx("input",{type:"range",min:"0",max:"100",value:v,onChange:$=>{$.stopPropagation(),de(r.id,parseInt($.target.value))},className:"flex-1 h-2 bg-white/20 rounded-lg appearance-none cursor-pointer",style:{background:`linear-gradient(to right, #6b7280 0%, #6b7280 ${v}%, rgba(255,255,255,0.2) ${v}%, rgba(255,255,255,0.2) 100%)`}}),e.jsxs("span",{className:"text-sm text-white/70 w-12 text-right font-medium",children:[v,"%"]})]})]},r.id)})})]}),g.filter(r=>!r.isOnline).length>0&&e.jsxs("div",{children:[e.jsxs("h4",{className:"text-white/60 text-sm font-semibold mb-4 flex items-center gap-3",children:[e.jsx(we,{className:"w-4 h-4"}),"OFFLINE"]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:g.filter(r=>!r.isOnline).map(r=>e.jsxs("div",{className:"flex items-center gap-3 p-4 opacity-50 rounded-xl border border-white/10",children:[e.jsx("div",{className:"w-6 h-6 rounded-lg border-2 border-white/20 bg-transparent"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("span",{className:"text-white/70 text-base font-medium",children:r.name}),e.jsx("p",{className:"text-white/50 text-sm",children:r.type})]}),e.jsx("span",{className:"text-red-400 text-sm ml-auto",children:"(Offline)"})]},r.id))})]})]}),e.jsxs("div",{className:"px-6 py-4 border-t border-white/20 flex gap-3",children:[e.jsx("button",{onClick:()=>x(new Set(g.filter(r=>r.isOnline).map(r=>r.id))),className:"flex-1 px-4 py-3 text-sm text-white/80 hover:text-white hover:bg-white/10 rounded-lg transition-colors font-medium",children:"Group All"}),e.jsx("button",{onClick:()=>x(new Set),className:"flex-1 px-4 py-3 text-sm text-white/80 hover:text-white hover:bg-white/10 rounded-lg transition-colors font-medium",children:"Ungroup All"}),e.jsxs("button",{onClick:Ne,className:"px-8 py-3 bg-green-600 hover:bg-green-700 text-white text-sm font-semibold rounded-lg transition-colors flex items-center gap-2",children:[e.jsx(He,{className:"w-4 h-4"}),"Apply Changes"]})]})]})})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("button",{onClick:()=>d(!D),className:"p-2 rounded-full transition-colors hover:bg-white/20 backdrop-blur-sm",children:e.jsx(be,{className:"w-4 h-4 text-white/80 drop-shadow"})}),D?e.jsxs("div",{className:"flex items-center gap-2 w-20",children:[e.jsx("input",{type:"range",min:"0",max:"100",value:P,onChange:r=>ae(parseInt(r.target.value)),className:"flex-1 h-2 bg-white/20 rounded-lg appearance-none cursor-pointer backdrop-blur-sm",style:{background:`linear-gradient(to right, white 0%, white ${P}%, rgba(255,255,255,0.2) ${P}%, rgba(255,255,255,0.2) 100%)`}}),e.jsxs("span",{className:"text-xs text-white/80 w-8 text-right font-medium drop-shadow",children:[P,"%"]})]}):e.jsxs("span",{className:"text-xs text-white/80 font-medium drop-shadow",children:[P,"%"]})]})]}),e.jsxs("div",{className:"flex-1 flex gap-4 items-center",children:[e.jsx("div",{className:"w-8"}),e.jsxs("div",{className:"flex-1 min-w-0 flex flex-col justify-center",children:[e.jsx("h3",{className:"font-bold text-2xl text-white truncate leading-tight mb-1 drop-shadow-lg",children:V||"No track playing"}),e.jsx("p",{className:"text-lg text-white/90 truncate mb-0.5 drop-shadow",children:l||"Unknown artist"}),e.jsx("p",{className:"text-sm text-white/70 truncate drop-shadow",children:(K==null?void 0:K.name)||"Unknown album"})]})]}),e.jsxs("div",{className:"flex-1 flex flex-col justify-end gap-3",children:[V&&e.jsx("div",{className:"px-8",children:e.jsxs("div",{className:"flex items-center gap-3 text-xs text-white/80 mb-2",children:[e.jsx("span",{className:"text-xs font-medium w-10 text-left drop-shadow",children:fe(j)}),e.jsx("div",{className:"flex-1 bg-white/20 rounded-full h-2 backdrop-blur-sm",children:e.jsx("div",{className:"bg-white h-2 rounded-full transition-all duration-300 shadow-sm",style:{width:`${ke}%`}})}),e.jsx("span",{className:"text-xs font-medium w-10 text-right drop-shadow",children:fe(f)})]})}),e.jsxs("div",{className:"flex items-center justify-center gap-4",children:[e.jsx("button",{onClick:m,disabled:!V,className:"p-3 rounded-full transition-colors disabled:opacity-50 disabled:cursor-not-allowed hover:bg-white/20 backdrop-blur-sm",children:e.jsx(Ze,{className:"w-6 h-6 text-white drop-shadow"})}),e.jsx("button",{onClick:X?n:s,disabled:!V,className:"p-4 bg-white/90 text-gray-900 rounded-full transition-colors disabled:opacity-50 disabled:cursor-not-allowed hover:bg-white shadow-lg backdrop-blur-sm",children:X?e.jsx(Je,{className:"w-6 h-6 fill-current"}):e.jsx(De,{className:"w-6 h-6 fill-current ml-0.5"})}),e.jsx("button",{onClick:a,disabled:!V,className:"p-3 rounded-full transition-colors disabled:opacity-50 disabled:cursor-not-allowed hover:bg-white/20 backdrop-blur-sm",children:e.jsx(Xe,{className:"w-6 h-6 text-white drop-shadow"})})]})]})]})]})}function ds({onError:t}){const[s,n]=i.useState([]),[a,m]=i.useState(null),[p,C]=i.useState([]),[h,E]=i.useState([]),[P,z]=i.useState(!0),[D,d]=i.useState(null),[k,R]=i.useState(!1),[T,U]=i.useState(!1),M=i.useRef(null);i.useRef(null);const A=i.useRef(null),b=i.useRef(Date.now());i.useEffect(()=>{const l=S=>{S.key==="Escape"&&k&&R(!1)};return k&&(document.addEventListener("keydown",l),document.body.style.overflow="hidden"),()=>{document.removeEventListener("keydown",l),document.body.style.overflow="unset"}},[k]),i.useEffect(()=>{let l=!0;const S=()=>_(null,null,function*(){try{z(!0),d(null);const g=(yield W.getEntitiesByType("media_player")).filter(N=>{var B,H,re,Q,te;return((H=(B=N.raw)==null?void 0:B.attributes)==null?void 0:H.device_class)==="speaker"||N.id.toLowerCase().includes("sonos")||N.name.toLowerCase().includes("sonos")||((te=(Q=(re=N.raw)==null?void 0:re.attributes)==null?void 0:Q.friendly_name)==null?void 0:te.toLowerCase().includes("sonos"))});if(!l)return;console.log("🎵 Sonos Widget - Found devices:",g.map(N=>{var B,H;return{id:N.id,name:N.name,state:N.state,isPlaying:N.isPlaying,mediaTitle:N.mediaTitle,mediaArtist:N.mediaArtist,mediaAlbum:N.mediaAlbum,mediaArtwork:N.mediaArtwork,rawEntityPicture:(H=(B=N.raw)==null?void 0:B.attributes)==null?void 0:H.entity_picture,hasArtwork:!!N.mediaArtwork}})),n(g);const I=g.find(N=>N.groupMembers&&N.groupMembers.length>0);let Y=null;if(I)Y=I,m(I);else if(g.length>0){const N=g.find(B=>B.isPlaying)||g[0];Y=N,m(N)}Y&&o(g,Y)}catch(w){if(!l)return;d(w.message),t==null||t(w),console.error("Error fetching media players:",w)}finally{l&&z(!1)}}),u=()=>_(null,null,function*(){try{yield W.connect(),l&&U(!0)}catch(w){console.error("Error connecting to Home Assistant:",w),l&&U(!1)}}),f=()=>_(null,null,function*(){try{return yield W.connect(),W.subscribe("*",g=>{if(l&&g.type==="media_player"&&(g.id.toLowerCase().includes("sonos")||g.name.toLowerCase().includes("sonos"))){const I=Date.now(),Y=(N,B)=>N?N.state!==B.state||N.mediaTitle!==B.mediaTitle||N.mediaArtist!==B.mediaArtist||N.mediaArtwork!==B.mediaArtwork||Math.abs((N.volumeLevel||0)-(B.volumeLevel||0))>.05:!0;if(I-b.current<500)return;clearTimeout(M.current),M.current=setTimeout(()=>{l&&(b.current=I,n(N=>{const B=N.find(H=>H.id===g.id);return g.state==="unavailable"?N:!B||Y(B,g)?N.map(H=>H.id===g.id?g:H):N}),m(N=>(N==null?void 0:N.id)===g.id&&g.state!=="unavailable"&&Y(N,g)?g:N))},300)}})}catch(w){return console.error("Error setting up scoped updates:",w),()=>{}}});S(),u();const j=f();return()=>{l=!1,clearTimeout(M.current),clearInterval(A.current),j.then(w=>w&&w())}},[]),i.useEffect(()=>(a!=null&&a.isPlaying&&(a!=null&&a.mediaDuration)?A.current=setInterval(()=>{m(l=>l!=null&&l.isPlaying&&(l==null?void 0:l.mediaPosition)<(l==null?void 0:l.mediaDuration)?ee(J({},l),{mediaPosition:Math.min(l.mediaPosition+1,l.mediaDuration)}):l)},1e3):clearInterval(A.current),()=>clearInterval(A.current)),[a==null?void 0:a.isPlaying,a==null?void 0:a.mediaDuration,a==null?void 0:a.id]);const x=()=>!(a!=null&&a.mediaDuration)||!(a!=null&&a.mediaPosition)?0:a.mediaPosition/a.mediaDuration*100,O=l=>{if(!l)return"0:00";const S=Math.floor(l/60),u=Math.floor(l%60);return`${S}:${u.toString().padStart(2,"0")}`},c=l=>l?l.startsWith("http://")||l.startsWith("https://")?l:`http://192.168.1.224:8123${l}`:null,o=i.useCallback((l,S)=>{if(!S)return;const u=l.filter(j=>j.id===S.id||S.groupMembers&&S.groupMembers.includes(j.id)),f=l.filter(j=>!u.find(w=>w.id===j.id)&&j.state!=="unavailable");C(j=>j.length!==u.length||!j.every(w=>u.find(g=>g.id===w.id))?u:j),E(j=>j.length!==f.length||!j.every(w=>f.find(g=>g.id===w.id))?f:j)},[]),y=l=>{m(l),o(s,l)},L=()=>_(null,null,function*(){if(!a){console.log("🎵 No selectedGroupLeader for play/pause");return}try{const l=a.id,S=a.isPlaying,u=!a.isPlaying,f=u?"playing":"paused";m(w=>(w==null?void 0:w.id)===l?ee(J({},w),{isPlaying:u,state:f}):w),n(w=>w.map(g=>g.id===l?ee(J({},g),{isPlaying:u,state:f}):g)),yield W.mediaPlayPause(l),d(null)}catch(l){console.error("🎵 Error toggling playback:",l),d(l.message),m(u=>(u==null?void 0:u.id)===a.id?ee(J({},u),{isPlaying:originalState,state:originalState?"playing":"paused"}):u),n(u=>u.map(f=>f.id===a.id?ee(J({},f),{isPlaying:originalState,state:originalState?"playing":"paused"}):f))}}),G=()=>_(null,null,function*(){if(a)try{m(l=>ee(J({},l),{mediaPosition:0})),yield W.callService("media_player","media_next_track",{entity_id:a.id}),d(null)}catch(l){console.error("🎵 Error skipping to next track:",l),d(l.message)}}),q=()=>_(null,null,function*(){if(a)try{m(l=>ee(J({},l),{mediaPosition:0})),yield W.callService("media_player","media_previous_track",{entity_id:a.id}),d(null)}catch(l){console.error("🎵 Error skipping to previous track:",l),d(l.message)}}),X=(l,S)=>_(null,null,function*(){try{const u=S/100,f=j=>j.id===l?ee(J({},j),{volumeLevel:u}):j;n(j=>j.map(f)),m(j=>(j==null?void 0:j.id)===l?ee(J({},j),{volumeLevel:u}):j),yield W.setVolume(l,u),d(null)}catch(u){console.error("🎵 Error setting volume:",u),d(u.message)}}),V=l=>_(null,null,function*(){if(a)try{const S=p.map(f=>f.id);yield W.callService("media_player","join",{entity_id:a.id,group_members:[...S,l]});const u=h.find(f=>f.id===l);u&&(C(f=>[...f,u]),E(f=>f.filter(j=>j.id!==l)))}catch(S){d(S.message),console.error("Error joining group:",S)}}),K=l=>_(null,null,function*(){if(l!==(a==null?void 0:a.id))try{yield W.callService("media_player","unjoin",{entity_id:l});const S=p.find(u=>u.id===l);S&&(C(u=>u.filter(f=>f.id!==l)),E(u=>[...u,S]))}catch(S){d(S.message),console.error("Error leaving group:",S)}});return P?e.jsxs("div",{className:"rounded-2xl p-4 bg-gradient-to-br from-slate-900 via-slate-800 to-slate-900 h-full flex flex-col overflow-hidden shadow-lg border border-slate-700/50 animate-pulse",children:[e.jsx("div",{className:"h-6 bg-slate-700 rounded-xl w-1/2 mb-4"}),e.jsx("div",{className:"h-16 bg-slate-700 rounded-2xl mb-4"}),e.jsx("div",{className:"h-8 bg-slate-700 rounded-xl w-3/4"})]}):D?e.jsx("div",{className:"rounded-2xl p-4 bg-gradient-to-br from-red-900 via-red-800 to-red-900 h-full flex flex-col overflow-hidden shadow-lg border border-red-700/50",children:e.jsxs("div",{className:"text-red-300 text-center flex-1 flex flex-col justify-center",children:[e.jsx(ce,{className:"w-12 h-12 mx-auto mb-3 text-red-400"}),e.jsx("p",{className:"font-semibold mb-2",children:"Sonos Error"}),e.jsx("p",{className:"text-sm text-red-200",children:D})]})}):!a||s.length===0||a.state==="unavailable"?e.jsx("div",{className:"rounded-2xl p-4 bg-gradient-to-br from-slate-900 via-slate-800 to-slate-900 h-full flex flex-col overflow-hidden shadow-lg border border-slate-700/50",children:e.jsxs("div",{className:"text-slate-400 text-center flex-1 flex flex-col justify-center",children:[e.jsx(ce,{className:"w-12 h-12 mx-auto mb-3"}),e.jsx("p",{className:"font-semibold mb-2 text-slate-300",children:"No Sonos Devices"}),e.jsx("p",{className:"text-sm",children:"No Sonos media players found"})]})}):e.jsxs("div",{className:"rounded-2xl p-4 bg-gradient-to-br from-slate-900 via-slate-800 to-slate-900 h-full flex flex-col overflow-hidden shadow-lg border border-slate-700/50",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-8 h-8 rounded-full bg-gradient-to-r from-[#1DB954] to-[#1ed760] flex items-center justify-center",children:e.jsx(ce,{className:"w-4 h-4 text-white"})}),e.jsx("span",{className:"font-semibold text-white",children:"Sonos"})]}),e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx("div",{className:`w-2 h-2 rounded-full ${T?"bg-[#1DB954] shadow-lg shadow-green-500/50":"bg-red-500"}`}),e.jsx("span",{className:"text-xs text-slate-400",children:T?"Live":"Offline"})]})]}),e.jsx("div",{className:"mb-4",children:e.jsxs("div",{className:"relative",children:[e.jsx("select",{value:(a==null?void 0:a.id)||"",onChange:l=>{const S=s.find(u=>u.id===l.target.value);S&&y(S)},className:"w-full bg-slate-700/50 backdrop-blur-sm border border-slate-600 rounded-xl px-3 py-2 text-xs text-white focus:ring-2 focus:ring-[#1DB954] focus:border-[#1DB954] appearance-none transition-all",children:s.map(l=>{var S;return e.jsxs("option",{value:l.id,className:"bg-slate-800 text-white",children:[l.name," ",((S=l.groupMembers)==null?void 0:S.length)>0?"(Leader)":""]},l.id)})}),e.jsx(Le,{className:"absolute right-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-slate-400 pointer-events-none"})]})}),e.jsxs("div",{className:"flex items-center space-x-4 mb-4",children:[a.mediaArtwork?e.jsx("div",{className:"relative group",children:e.jsxs("div",{className:"relative",children:[e.jsx("img",{src:c(a.mediaArtwork),alt:"Album art",className:"w-16 h-16 rounded-2xl object-cover shadow-2xl relative z-10",onError:l=>{console.log("🎵 Album art failed to load:",a.mediaArtwork),console.log("🎵 Processed URL:",c(a.mediaArtwork))}}),e.jsx("div",{className:"absolute inset-0 w-16 h-16 rounded-full bg-gradient-to-br from-slate-800 to-black shadow-xl transform -rotate-12 opacity-40 -z-10"}),e.jsx("div",{className:"absolute inset-0 w-16 h-16 rounded-2xl bg-gradient-to-br from-[#1DB954]/20 to-transparent blur-sm -z-20 group-hover:from-[#1DB954]/40 transition-all duration-500"}),a.isPlaying&&e.jsx("div",{className:"absolute inset-0 rounded-2xl bg-black/20 flex items-center justify-center opacity-0 group-hover:opacity-100 transition-all duration-300",children:e.jsx("div",{className:"w-3 h-3 rounded-full bg-white/80 animate-pulse"})}),e.jsx("div",{className:"absolute inset-0 rounded-2xl bg-gradient-to-tr from-white/10 to-transparent pointer-events-none"})]})}):e.jsx("div",{className:"relative group",children:e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"w-16 h-16 rounded-2xl bg-gradient-to-br from-slate-700 to-slate-800 flex items-center justify-center shadow-2xl relative z-10 border border-slate-600/30",children:e.jsx(ce,{className:"w-6 h-6 text-slate-400"})}),e.jsx("div",{className:"absolute inset-0 w-16 h-16 rounded-full bg-gradient-to-br from-slate-700 to-slate-900 shadow-xl transform -rotate-12 opacity-40 -z-10"}),e.jsx("div",{className:"absolute inset-0 w-16 h-16 rounded-2xl bg-gradient-to-br from-slate-600/20 to-transparent blur-sm -z-20"}),e.jsx("div",{className:"absolute inset-0 rounded-2xl bg-gradient-to-tr from-white/5 to-transparent pointer-events-none"})]})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h4",{className:"font-semibold text-white truncate text-sm leading-tight",children:a.mediaTitle||"No media playing"}),e.jsx("p",{className:"text-xs text-slate-300 truncate mt-1",children:a.mediaArtist||"Unknown Artist"}),a.mediaAlbum&&e.jsx("p",{className:"text-xs text-slate-400 truncate",children:a.mediaAlbum})]})]}),a.mediaDuration&&e.jsxs("div",{className:"mb-4",children:[e.jsx("div",{className:"w-full bg-slate-700/50 rounded-full h-1.5 overflow-hidden",children:e.jsx("div",{className:"bg-gradient-to-r from-[#1DB954] to-[#1ed760] h-1.5 rounded-full transition-all duration-1000 shadow-sm",style:{width:`${x()}%`}})}),e.jsxs("div",{className:"flex justify-between text-xs text-slate-400 mt-2 font-mono",children:[e.jsx("span",{children:O(a.mediaPosition)}),e.jsx("span",{children:O(a.mediaDuration)})]})]}),e.jsxs("div",{className:"flex items-center justify-center space-x-4 mb-4",children:[e.jsx("button",{onClick:q,className:"p-3 rounded-full bg-slate-700/50 backdrop-blur-sm border border-slate-600/50 hover:bg-slate-600/50 hover:scale-105 transition-all duration-200 group",children:e.jsx(Ze,{className:"w-5 h-5 text-slate-300 group-hover:text-white"})}),e.jsx("button",{onClick:L,className:"p-4 rounded-full bg-gradient-to-r from-[#1DB954] to-[#1ed760] hover:from-[#1ed760] hover:to-[#1DB954] text-white transition-all duration-200 hover:scale-110 shadow-lg shadow-green-500/25",children:a.isPlaying?e.jsx(Je,{className:"w-6 h-6"}):e.jsx(De,{className:"w-6 h-6 ml-0.5"})}),e.jsx("button",{onClick:G,className:"p-3 rounded-full bg-slate-700/50 backdrop-blur-sm border border-slate-600/50 hover:bg-slate-600/50 hover:scale-105 transition-all duration-200 group",children:e.jsx(Xe,{className:"w-5 h-5 text-slate-300 group-hover:text-white"})})]}),e.jsx("div",{className:"border-t border-slate-700/50 pt-3",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("h5",{className:"text-sm font-medium text-white flex items-center",children:[e.jsx(he,{className:"w-4 h-4 mr-2 text-slate-300"}),"Groups (",p.length,")"]}),e.jsx("button",{onClick:()=>R(!0),className:"text-xs text-[#1DB954] hover:text-[#1ed760] font-medium transition-colors px-2 py-1 rounded-lg hover:bg-slate-700/30",children:"Show"})]})}),k&&e.jsx("div",{className:"fixed inset-0 bg-black/70 backdrop-blur-sm flex items-center justify-center z-50 p-4",onClick:l=>{l.target===l.currentTarget&&R(!1)},children:e.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl w-full max-w-2xl max-h-[85vh] overflow-hidden animate-in fade-in-0 zoom-in-95 duration-200 mx-4 sm:mx-0",children:[e.jsx("div",{className:"bg-gradient-to-r from-slate-900 to-slate-800 p-6 text-white",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 rounded-full bg-gradient-to-r from-[#1DB954] to-[#1ed760] flex items-center justify-center",children:e.jsx(he,{className:"w-5 h-5 text-white"})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-bold",children:"Sonos Groups"}),e.jsx("p",{className:"text-sm text-slate-300",children:"Manage your speaker groups"})]})]}),e.jsx("button",{onClick:()=>R(!1),className:"p-2 rounded-full hover:bg-white/10 transition-colors",children:e.jsx(ye,{className:"w-6 h-6 rotate-45"})})]})}),e.jsxs("div",{className:"p-6 space-y-6 overflow-y-auto max-h-[60vh]",children:[e.jsx("div",{className:"bg-gradient-to-r from-blue-50 to-indigo-50 rounded-xl p-4 border border-blue-200",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-12 h-12 rounded-xl bg-gradient-to-r from-blue-500 to-indigo-500 flex items-center justify-center",children:e.jsx(ce,{className:"w-6 h-6 text-white"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-gray-900",children:"Group Leader"}),e.jsx("p",{className:"text-sm text-gray-600",children:a==null?void 0:a.name})]})]})}),e.jsxs("div",{children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center gap-2",children:[e.jsx(he,{className:"w-5 h-5 text-gray-600"}),"Currently Grouped (",p.length,")"]}),e.jsx("div",{className:"space-y-3",children:p.map(l=>e.jsx("div",{className:"bg-gradient-to-r from-green-50 to-emerald-50 rounded-xl p-4 border border-green-200",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3 flex-1",children:[e.jsx("div",{className:"w-10 h-10 rounded-xl bg-gradient-to-r from-green-500 to-emerald-500 flex items-center justify-center",children:e.jsx(ce,{className:"w-5 h-5 text-white"})}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"font-medium text-gray-900",children:l.name}),l.id===(a==null?void 0:a.id)&&e.jsx("span",{className:"px-3 py-1 bg-blue-100 text-blue-800 text-xs rounded-full font-medium",children:"Leader"})]}),e.jsx("div",{className:"flex items-center mt-3 gap-3",children:e.jsxs("div",{className:"flex items-center gap-2",children:[l.isMuted?e.jsx(Be,{className:"w-4 h-4 text-gray-500"}):e.jsx(be,{className:"w-4 h-4 text-gray-600"}),e.jsx("input",{type:"range",min:"0",max:"100",value:Math.round((l.volumeLevel||0)*100),onChange:S=>X(l.id,parseInt(S.target.value)),className:"flex-1 sonos-volume-slider"}),e.jsxs("span",{className:"text-sm text-gray-600 w-10 text-right font-mono",children:[Math.round((l.volumeLevel||0)*100),"%"]})]})})]})]}),l.id!==(a==null?void 0:a.id)&&e.jsx("button",{onClick:()=>K(l.id),className:"ml-4 p-2 rounded-full bg-red-100 text-red-600 hover:bg-red-200 hover:text-red-700 transition-all duration-200",title:"Remove from group",children:e.jsx(Qe,{className:"w-4 h-4"})})]})},l.id))})]}),h.length>0&&e.jsxs("div",{children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center gap-2",children:[e.jsx(ye,{className:"w-5 h-5 text-gray-600"}),"Available to Add (",h.length,")"]}),e.jsx("div",{className:"space-y-3",children:h.map(l=>e.jsx("div",{className:"bg-gray-50 rounded-xl p-4 border border-gray-200 hover:border-gray-300 transition-colors",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3 flex-1",children:[e.jsx("div",{className:"w-10 h-10 rounded-xl bg-gradient-to-r from-gray-400 to-gray-500 flex items-center justify-center",children:e.jsx(ce,{className:"w-5 h-5 text-white"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("span",{className:"font-medium text-gray-900",children:l.name}),e.jsx("div",{className:"flex items-center mt-3 gap-3",children:e.jsxs("div",{className:"flex items-center gap-2",children:[l.isMuted?e.jsx(Be,{className:"w-4 h-4 text-gray-500"}):e.jsx(be,{className:"w-4 h-4 text-gray-600"}),e.jsx("input",{type:"range",min:"0",max:"100",value:Math.round((l.volumeLevel||0)*100),onChange:S=>X(l.id,parseInt(S.target.value)),className:"flex-1 sonos-volume-slider"}),e.jsxs("span",{className:"text-sm text-gray-600 w-10 text-right font-mono",children:[Math.round((l.volumeLevel||0)*100),"%"]})]})})]})]}),e.jsx("button",{onClick:()=>V(l.id),className:"ml-4 p-2 rounded-full bg-green-100 text-green-600 hover:bg-green-200 hover:text-green-700 transition-all duration-200",title:"Add to group",children:e.jsx(ye,{className:"w-4 h-4"})})]})},l.id))})]}),h.length===0&&e.jsxs("div",{className:"text-center py-8",children:[e.jsx(he,{className:"w-12 h-12 text-gray-400 mx-auto mb-3"}),e.jsx("h3",{className:"font-medium text-gray-900 mb-2",children:"All speakers are grouped"}),e.jsx("p",{className:"text-sm text-gray-600",children:"All available Sonos speakers are already in this group."})]})]}),e.jsx("div",{className:"bg-gray-50 px-6 py-4 rounded-b-2xl",children:e.jsx("div",{className:"flex justify-end",children:e.jsx("button",{onClick:()=>R(!1),className:"px-6 py-2 bg-gradient-to-r from-[#1DB954] to-[#1ed760] text-white rounded-xl hover:from-[#1ed760] hover:to-[#1DB954] transition-all duration-200 font-medium",children:"Done"})})})]})})]})}const ms=i.memo(ds);class us{constructor(){this.ws=null,this.subscribers=new Set,this.reconnectAttempts=0,this.maxReconnectAttempts=5,this.reconnectDelay=1e3,this.isConnected=!1,this.lastMotionEvents=new Map,this.brokerUrl="ws://192.168.1.224:1883"}connect(){try{this.attemptWebSocketConnection()}catch(s){this.fallbackToSimulation()}}attemptWebSocketConnection(){try{const s=new WebSocket(this.brokerUrl);s.onopen=()=>{console.log("✅ WebSocket connection established to Ring MQTT broker"),s.close(),this.establishMqttConnection()},s.onerror=n=>{this.fallbackToSimulation()},s.onclose=n=>{n.code!==1e3&&this.fallbackToSimulation()},setTimeout(()=>{s.readyState===WebSocket.CONNECTING&&(s.close(),this.fallbackToSimulation())},5e3)}catch(s){console.error("❌ Error creating WebSocket connection:",s),this.fallbackToSimulation()}}establishMqttConnection(){console.log("📡 Would establish MQTT connection here..."),console.log("💡 Note: Need to install mqtt.js for real MQTT WebSocket support"),this.simulateConnection()}fallbackToSimulation(){console.log("🎭 Ring MQTT broker not available - using simulation mode for demo"),this.simulateConnection()}simulateConnection(){console.log("✅ Connected to Ring MQTT broker (simulated)"),console.log("📊 Subscribers count:",this.subscribers.size),this.isConnected=!0,this.reconnectAttempts=0,this.subscribeToRingTopics(),this.simulateMotionEvents()}subscribeToRingTopics(){console.log("📡 Subscribing to Ring alarm topics:",["ring/+/alarm/+/status","ring/+/camera/+/motion/state","ring/+/alarm/+/motion/state","ring/+/alarm/+/sensor/+/state"])}simulateMotionEvents(){console.log("🎭 Starting Ring alarm event simulation...");const s=()=>{if(!this.isConnected){console.log("❌ Not connected, skipping simulation");return}const n=[{id:"front_door_camera",name:"Front Door Camera",type:"camera",location:"Home"},{id:"back_yard_camera",name:"Back Yard Camera",type:"camera",location:"Home"},{id:"motion_sensor_living",name:"Living Room Motion",type:"sensor",location:"Home"},{id:"contact_sensor_door",name:"Front Door Contact",type:"sensor",location:"Home"}],a=n[Math.floor(Math.random()*n.length)];if((Math.random()>.7?"motion":"none")==="motion"){const p={timestamp:new Date().toISOString(),state:"ON",device:a.name,device_id:a.id,device_type:a.type,location:a.location,topic:`ring/home/${a.type}/${a.id}/motion/state`};console.log("🚨 Ring motion detected:",a.name),this.handleMotionEvent(p)}setTimeout(s,Math.random()*15e3+15e3)};console.log("⏰ First alarm simulation in 5 seconds..."),setTimeout(s,5e3)}handleMotionEvent(s){this.lastMotionEvents.set(s.device_id,ee(J({},s),{timestamp:new Date(s.timestamp)})),this.subscribers.forEach(n=>{try{n(s)}catch(a){console.error("Error notifying motion subscriber:",a)}}),s.state==="ON"&&setTimeout(()=>{const n=ee(J({},s),{state:"OFF",timestamp:new Date().toISOString()});this.subscribers.forEach(a=>{try{a(n)}catch(m){console.error("Error notifying motion end subscriber:",m)}})},5e3)}subscribe(s){return this.subscribers.add(s),()=>{this.subscribers.delete(s)}}getLastMotionEvents(){return Array.from(this.lastMotionEvents.values()).filter(s=>{const n=new Date(Date.now()-3e5);return s.timestamp>n}).sort((s,n)=>n.timestamp-s.timestamp)}scheduleReconnect(){if(this.reconnectAttempts>=this.maxReconnectAttempts){console.error("❌ Max reconnection attempts reached");return}const s=this.reconnectDelay*Math.pow(2,this.reconnectAttempts);console.log(`🔄 Scheduling reconnection attempt ${this.reconnectAttempts+1} in ${s}ms`),setTimeout(()=>{this.reconnectAttempts++,this.connect()},s)}sendAlarmCommand(s){return _(this,null,function*(){if(console.log("🛡️ Sending Ring alarm command:",s),!this.isConnected)return console.warn("⚠️ Not connected to Ring MQTT broker - cannot send command"),!1;try{const n={command:s,timestamp:new Date().toISOString(),source:"family-hub"};return console.log("📤 Publishing alarm command to ring/alarm/command:",n),!0}catch(n){return console.error("❌ Failed to send Ring alarm command:",n),!1}})}disconnect(){this.ws&&(this.ws.close(),this.ws=null),this.isConnected=!1,console.log("🔌 Disconnected from Ring MQTT broker")}}const Te=new us;Te.connect();const hs=Object.freeze(Object.defineProperty({__proto__:null,ringMqttClient:Te},Symbol.toStringTag,{value:"Module"}));function gs(){const[t,s]=i.useState("disarmed"),[n,a]=i.useState(!1),[m,p]=i.useState(null),[C,h]=i.useState([]);i.useEffect(()=>{console.log("🔧 Setting up Ring MQTT alarm integration..."),a(Te.isConnected);const d=Te.subscribe(k=>{var R,T;console.log("🚨 Ring MQTT alarm event received:",k),((R=k.topic)!=null&&R.includes("/alarm/")||(T=k.topic)!=null&&T.includes("/motion/"))&&E(k)});return()=>{console.log("🔌 Cleaning up Ring MQTT alarm subscription"),d()}},[]);const E=i.useCallback(d=>{var R,T;console.log("🔍 Processing Ring alarm event:",d);const k=new Date;if((R=d.topic)!=null&&R.includes("/motion/state")&&(d.state==="ON"?(p({type:"motion_detected",device:d.device,device_id:d.device_id,location:d.location,timestamp:k,topic:d.topic}),h(U=>U.find(A=>A.device_id===d.device_id)?U.map(A=>A.device_id===d.device_id?ee(J({},A),{status:"triggered",lastTriggered:k}):A):[...U,{device_id:d.device_id,name:d.device,type:"motion",status:"triggered",lastTriggered:k}]),console.log("🚨 Motion detected - updating alarm sensors")):d.state==="OFF"&&(h(U=>U.map(M=>M.device_id===d.device_id?ee(J({},M),{status:"normal",lastCleared:k}):M)),console.log("✅ Motion cleared - updating alarm sensors"))),(T=d.topic)!=null&&T.includes("/alarm/status")){console.log("🛡️ Ring alarm status change:",d.state);let U=d.state.toLowerCase();(U==="away"||U==="home")&&(U="armed_home",console.log(`🔄 Mapped MQTT "${d.state}" → "armed_home" for widget display`)),s(U),p({type:"status_change",status:U,originalMqttStatus:d.state.toLowerCase(),timestamp:k,topic:d.topic})}},[]),P=i.useCallback(()=>C.filter(d=>d.status==="triggered"&&d.type==="motion"&&new Date-d.lastTriggered<300*1e3),[C]),z=i.useCallback(()=>P().length>0,[P]),D=i.useCallback(()=>{const d=P();return{status:t,isConnected:n,activeMotions:d.length,lastEvent:m,sensorStatuses:C,hasActiveMotion:z()}},[t,n,m,C,P,z]);return{alarmStatus:t,isConnected:n,lastAlarmEvent:m,sensorStatuses:C,getActiveMotionSensors:P,hasActiveMotion:z,getAlarmSummary:D}}function xs({isVisible:t=!1,onDisarm:s}){const[n,a]=i.useState(!1);if(i.useEffect(()=>{a(!!t)},[t]),!t)return null;const m=()=>{s==null||s()};return e.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center",children:[e.jsx("div",{className:"absolute inset-0",style:{background:"radial-gradient(circle at center, rgba(239, 68, 68, 0.9) 0%, rgba(239, 68, 68, 0.6) 40%, rgba(239, 68, 68, 0.3) 70%, transparent 100%)"}}),e.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:e.jsxs("div",{className:"relative w-[500px] h-[500px]",style:{background:"radial-gradient(circle, rgba(239, 68, 68, 0.1) 0%, transparent 70%)"},children:[[...Array(12)].map((p,C)=>e.jsx("div",{className:`absolute top-1/2 left-1/2 origin-bottom w-1 bg-gradient-to-t from-red-400 to-transparent ${n?"animate-radar-trail":""}`,style:{height:"240px",transformOrigin:"bottom center",transform:"translate(-50%, -100%)",animationDelay:`${C*.167}s`,opacity:.3-C*.025}},`trail-${C}`)),e.jsx("div",{className:`absolute top-1/2 left-1/2 origin-bottom w-1 bg-gradient-to-t from-red-500 via-red-400 to-transparent ${n?"animate-radar-sweep":""}`,style:{height:"240px",transformOrigin:"bottom center",transform:"translate(-50%, -100%)",boxShadow:"0 0 10px rgba(239, 68, 68, 0.8)"}}),[1,2,3,4,5].map(p=>e.jsx("div",{className:"absolute border border-red-400 rounded-full opacity-20",style:{width:`${p*20}%`,height:`${p*20}%`,top:"50%",left:"50%",transform:"translate(-50%, -50%)"}},p))]})}),e.jsxs("div",{className:"relative z-10 text-center",children:[e.jsx("div",{className:"mb-6",children:e.jsx(Ke,{className:"w-20 h-20 text-white mx-auto animate-pulse"})}),e.jsx("h1",{className:"text-6xl font-bold text-white mb-8 animate-pulse",children:"ALARM SOUNDING"}),e.jsx("button",{onClick:m,className:"px-12 py-4 bg-red-600 hover:bg-red-700 active:bg-red-800 text-white text-2xl font-bold rounded-lg transition-all duration-200 transform hover:scale-105 active:scale-95 shadow-2xl border-2 border-red-400",children:"DISARM"})]}),e.jsx("style",{jsx:!0,children:`
        @keyframes radar-sweep {
          0% {
            transform: translate(-50%, -100%) rotate(0deg);
            opacity: 1;
          }
          100% {
            transform: translate(-50%, -100%) rotate(360deg);
            opacity: 1;
          }
        }
        
        @keyframes radar-trail {
          0% {
            transform: translate(-50%, -100%) rotate(0deg);
            opacity: 0;
          }
          5% {
            opacity: 0.6;
          }
          50% {
            opacity: 0.3;
          }
          95% {
            opacity: 0.1;
          }
          100% {
            transform: translate(-50%, -100%) rotate(360deg);
            opacity: 0;
          }
        }
        
        .animate-radar-sweep {
          animation: radar-sweep 2s linear infinite;
        }
        
        .animate-radar-trail {
          animation: radar-trail 2s linear infinite;
        }
      `})]})}function fs({alarmPanelId:t,alarmData:s={},onArmHome:n,onArmAway:a,onDisarm:m,onShowStatus:p}){const{entity:C,loading:h,error:E,callService:P,isConnected:z}=je(t,!!t),{isConnected:D}=gs(),[d,k]=i.useState(!1),[R,T]=i.useState(null),[U,M]=i.useState(!1),[A,b]=i.useState(!1),[x,O]=i.useState(!1),[c,o]=i.useState(""),[y,L]=i.useState(null),[G,q]=i.useState(""),X="7870",V=C||s,{state:K="disarmed",isConnected:l=C?z:!1,lastChanged:S=null,batteryStatus:u={},sensorStatuses:f=[],codeArmRequired:j=!1,codeFormat:w=null}=V,g=R||K,I=(Q,te=null)=>_(null,null,function*(){if(!d){if((j||Q==="disarm")&&!te&&!C){L(Q),O(!0);return}k(!0),M(!0);try{T(Q==="home"?"armed_home":Q==="away"?"armed_away":Q==="night"?"armed_night":"disarmed");let ae=!1;if(D){console.log("🔄 Attempting Ring alarm command via MQTT...");const{ringMqttClient:ie}=yield Ee(()=>_(null,null,function*(){const{ringMqttClient:de}=yield Promise.resolve().then(()=>hs);return{ringMqttClient:de}}),void 0);ae=yield ie.sendAlarmCommand(`arm_${Q==="disarm"?"disarm":Q}`),console.log(ae?"✅ Ring alarm command sent via MQTT":"⚠️ MQTT command failed, trying Home Assistant fallback...")}if(!ae&&C){switch(console.log("🔄 Using Home Assistant alarm service..."),Q){case"home":yield P("alarm_arm_home",te?{code:te}:{}),ae=!0;break;case"away":yield P("alarm_arm_away",te?{code:te}:{}),ae=!0;break;case"night":yield P("alarm_arm_night",te?{code:te}:{}),ae=!0;break;case"disarm":yield P("alarm_disarm",te?{code:te}:{}),ae=!0;break}ae&&console.log("✅ Ring alarm command sent via Home Assistant")}if(!ae){switch(console.log("🔄 Using legacy callback props..."),Q){case"home":yield n==null?void 0:n();break;case"away":yield a==null?void 0:a();break;case"disarm":yield m==null?void 0:m();break}ae=!0,console.log("✅ Ring alarm command sent via legacy callbacks")}}catch(le){console.error("❌ Failed to change alarm status:",le),T(null)}finally{setTimeout(()=>{k(!1),M(!1)},2e3)}}}),Y=()=>{y&&(c===X||!w?(O(!1),o(""),q(""),I(y,c||X),L(null)):q("Invalid PIN code"))},N=()=>{O(!1),o(""),q(""),L(null)},B=["armed_home","armed_away","armed_night"].includes(g);if(t&&h)return e.jsx("div",{className:"bg-gray-50 rounded-lg p-4 border border-gray-200 h-full flex flex-col",children:e.jsx("div",{className:"flex items-center justify-center flex-1",children:e.jsxs("div",{className:"text-center",children:[e.jsx($e,{className:"w-8 h-8 text-gray-400 mx-auto mb-2 animate-pulse"}),e.jsx("p",{className:"text-xs text-gray-500",children:"Loading alarm status..."})]})})});if(t&&E)return e.jsx("div",{className:"bg-red-50 rounded-lg p-4 border border-red-200 h-full flex flex-col",children:e.jsx("div",{className:"flex items-center justify-center flex-1",children:e.jsxs("div",{className:"text-center",children:[e.jsx(Ke,{className:"w-8 h-8 text-red-400 mx-auto mb-2"}),e.jsx("p",{className:"text-xs text-red-600",children:"Error loading alarm"})]})})});if(!l)return e.jsx("div",{className:"bg-gray-50 rounded-lg p-4 border border-gray-200 h-full flex flex-col",children:e.jsx("div",{className:"flex items-center justify-center flex-1",children:e.jsxs("div",{className:"text-center",children:[e.jsx($e,{className:"w-8 h-8 text-gray-400 mx-auto mb-2"}),e.jsx("p",{className:"text-xs text-gray-500",children:"Not connected"})]})})});const H=()=>{d||I(B?"disarm":"away")},re=()=>B?"border-red-500 bg-red-50":"border-green-500 bg-green-50";return e.jsxs(e.Fragment,{children:[e.jsx(xs,{isVisible:g==="triggered"||A,onDisarm:()=>{b(!1),I("disarm")}}),x&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-lg p-6 w-80 max-w-sm mx-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("h3",{className:"text-lg font-semibold flex items-center gap-2",children:[e.jsx(yt,{className:"w-5 h-5"}),"Enter PIN"]}),e.jsx("button",{onClick:N,className:"text-gray-400 hover:text-gray-600",children:e.jsx(we,{className:"w-5 h-5"})})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("input",{type:"password",value:c,onChange:Q=>{o(Q.target.value),q("")},onKeyPress:Q=>Q.key==="Enter"&&Y(),placeholder:"Enter PIN code",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",autoFocus:!0}),G&&e.jsx("p",{className:"text-sm text-red-600 mt-1",children:G})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:N,className:"flex-1 px-4 py-2 border border-gray-300 rounded-lg hover:bg-gray-50",children:"Cancel"}),e.jsx("button",{onClick:Y,disabled:!c,className:"flex-1 px-4 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600 disabled:opacity-50 disabled:cursor-not-allowed",children:"Confirm"})]})]})}),e.jsxs("div",{className:`rounded-lg p-4 border h-full flex flex-col cursor-pointer transition-all duration-200 active:scale-95 ${re()}`,onClick:H,children:[e.jsx("style",{jsx:!0,children:`
        @keyframes lockOpen {
          0% { transform: rotate(0deg) scale(1); }
          25% { transform: rotate(-10deg) scale(1.1); }
          50% { transform: rotate(10deg) scale(1.2); }
          75% { transform: rotate(-5deg) scale(1.1); }
          100% { transform: rotate(0deg) scale(1); }
        }
        
        @keyframes lockClose {
          0% { transform: rotate(0deg) scale(1); }
          25% { transform: rotate(10deg) scale(1.1); }
          50% { transform: rotate(-10deg) scale(1.2); }
          75% { transform: rotate(5deg) scale(1.1); }
          100% { transform: rotate(0deg) scale(1); }
        }
        
        .lock-animating-open {
          animation: lockOpen 600ms ease-in-out;
        }
        
        .lock-animating-close {
          animation: lockClose 600ms ease-in-out;
        }
      `}),e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx($e,{className:"w-8 h-8"}),D&&e.jsx("div",{className:"w-2 h-2 bg-green-500 rounded-full animate-pulse",title:"Ring MQTT Connected"})]}),e.jsx("div",{className:"flex items-center gap-2",children:e.jsx("button",{onClick:Q=>{Q.stopPropagation(),b(!0)},className:"px-2 py-1 text-xs bg-gray-500 text-white rounded hover:bg-gray-600 transition-colors",children:"Test Modal"})})]}),e.jsx("div",{className:"flex-1 flex items-center justify-center mt-3",children:e.jsx("h2",{className:`text-3xl font-bold ${B?"text-red-500":"text-green-500"}`,children:B?"Armed":"Disarmed"})}),e.jsx("div",{className:"flex-1 flex items-end justify-center pb-2",children:e.jsx("button",{onClick:Q=>{Q.stopPropagation(),H()},className:`w-full py-4 rounded-lg text-lg font-semibold transition-all duration-200 flex items-center justify-center gap-2 ${B?"bg-red-500 text-white hover:bg-red-600":"bg-green-500 text-white hover:bg-green-600"} ${d?"opacity-50 cursor-not-allowed":""}`,disabled:d,children:e.jsxs(e.Fragment,{children:[B?e.jsx(jt,{className:`w-5 h-5 ${U&&R==="disarmed"?"lock-animating-open":""}`}):e.jsx(Ve,{className:`w-5 h-5 ${U&&(R==="armed_home"||R==="armed_away")?"lock-animating-close":""}`}),B?"Disarm":"Arm"]})})})]})]})}function ps({thermostatData:t={},onSetTemperature:s,onSetMode:n,onToggleLocation:a,isActive:m=!0}){const[p,C]=i.useState(t.targetTemp||70),[h,E]=i.useState(!1),{currentTemp:P=72,targetTemp:z=70,mode:D="auto",location:d="downstairs",isOnline:k=!0,humidity:R=null,isHeating:T=!1,isCooling:U=!1,fanRunning:M=!1,schedule:A=null}=t,b=o=>_(null,null,function*(){if(h||!m)return;const y=Math.max(50,Math.min(90,p+o));C(y),E(!0);try{yield s==null?void 0:s(d,y),setTimeout(()=>E(!1),1e3)}catch(L){console.error("Failed to set temperature:",L),E(!1)}}),x=()=>{if(!m)return;const o=d==="upstairs"?"downstairs":"upstairs";a==null||a(o)},O=o=>o==="upstairs"?e.jsx(it,{className:"w-4 h-4"}):e.jsx(ve,{className:"w-4 h-4"}),c=o=>{m&&(n==null||n(d,o))};return e.jsxs("div",{className:`rounded-lg p-3 border-2 h-full flex flex-col overflow-hidden transition-all ${m?"border-[#b75634] bg-orange-50":"border-gray-300 bg-gray-100 opacity-60"}`,children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx(Ht,{className:`w-8 h-8 ${m?"":"text-gray-400"}`}),e.jsxs("button",{onClick:x,disabled:!m,className:`px-3 py-1 border rounded-lg text-xs font-medium transition-colors flex items-center gap-1 ${m?"bg-white/70 border-gray-300 hover:bg-white":"bg-gray-200 border-gray-400 text-gray-500 cursor-not-allowed"}`,children:[O(d),d.charAt(0).toUpperCase()+d.slice(1)]})]}),e.jsxs("div",{className:"flex flex-col justify-between flex-1",children:[e.jsxs("div",{className:"flex items-center justify-between flex-1 px-2 -mt-5",children:[e.jsx("button",{onClick:()=>b(-1),className:`p-3 transition-colors active:scale-95 ${m?"text-blue-600 hover:text-blue-700":"text-gray-400 cursor-not-allowed"}`,disabled:h||D==="off"||!m,children:e.jsx(Le,{className:"w-8 h-8"})}),e.jsx("div",{className:"text-center",children:e.jsxs("div",{className:"flex items-baseline justify-center gap-2",children:[e.jsx("span",{className:`text-6xl font-bold ${m?"text-[#b75634]":"text-gray-400"}`,children:Math.round(p)}),e.jsx("span",{className:`text-2xl ${m?"text-[#b75634]":"text-gray-400"}`,children:"°F"})]})}),e.jsx("button",{onClick:()=>b(1),className:`p-3 transition-colors active:scale-95 ${m?"text-red-600 hover:text-red-700":"text-gray-400 cursor-not-allowed"}`,disabled:h||D==="off"||!m,children:e.jsx(mt,{className:"w-8 h-8"})})]}),e.jsx("div",{className:"grid grid-cols-4 gap-0.5 pb-2",children:["off","heat","cool","auto"].map(o=>e.jsx("button",{onClick:()=>c(o),disabled:!m,className:`py-1.5 px-1 rounded-sm text-xs font-medium transition-all flex items-center justify-center ${m?D===o?"bg-white shadow-sm font-bold border border-gray-300":"bg-white/50 border border-transparent hover:bg-white/70":"bg-gray-200 border border-gray-300 text-gray-500 cursor-not-allowed"}`,children:o==="off"?"Off":o==="heat"?e.jsx(ft,{className:`w-3 h-3 ${m?"":"text-gray-400"}`}):o==="cool"?e.jsx(Ot,{className:`w-3 h-3 ${m?"":"text-gray-400"}`}):"Auto"},o))})]}),!k&&e.jsx("div",{className:"mt-2 text-center",children:e.jsx("span",{className:"text-xs text-gray-500",children:"Offline"})})]})}function bs(){return e.jsx("div",{className:"flex items-center justify-center min-h-[400px]",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-500 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-600",children:"Loading Home Assistant devices..."})]})})}function ys({error:t,onRetry:s}){return e.jsx("div",{className:"flex items-center justify-center min-h-[400px]",children:e.jsxs("div",{className:"text-center max-w-md mx-auto p-6 bg-red-50 rounded-lg border border-red-200",children:[e.jsx("div",{className:"text-red-600 mb-2",children:"⚠️"}),e.jsx("h3",{className:"text-lg font-semibold text-red-800 mb-2",children:"Connection Error"}),e.jsx("p",{className:"text-red-700 mb-4 text-sm",children:(t==null?void 0:t.message)||"Unable to connect to Home Assistant"}),e.jsx("button",{onClick:s,className:"px-4 py-2 bg-red-600 text-white rounded-md hover:bg-red-700 transition-colors",children:"Retry Connection"})]})})}function Ms(){var B,H,re,Q,te,le,ae,ie,de,Ne,_e,fe,ke,Se,pe;const{devices:t,scenes:s,loading:n,error:a,toggleDevice:m,updateDevice:p,activateScene:C,callService:h,isConnected:E,refreshStates:P}=rt(),[z,D]=i.useState(null),[d,k]=i.useState(!1),[R,T]=i.useState(!1),[U,M]=i.useState(!1),A=(t==null?void 0:t.filter(r=>r.entity_id.startsWith("light.")))||[],b=(t==null?void 0:t.filter(r=>r.entity_id.startsWith("switch.")))||[],x=s||[],[O,c]=i.useState(()=>(localStorage.removeItem("selectedScenes"),localStorage.removeItem("selectedDevices"),console.log("🗑️ Cleared localStorage to force device re-selection"),new Set)),[o,y]=i.useState(()=>new Set),[L,G]=i.useState(!1);i.useEffect(()=>{localStorage.setItem("selectedScenes",JSON.stringify([...O]))},[O]),i.useEffect(()=>{localStorage.setItem("selectedDevices",JSON.stringify([...o]))},[o]),i.useEffect(()=>{const r=A.filter(Z=>o.has(Z.entity_id)),v=b.filter(Z=>o.has(Z.entity_id)),$=x.filter(Z=>O.has(Z.entity_id)),se=(t==null?void 0:t.filter(Z=>Z.entity_id.startsWith("media_player.")))||[],ge=se.filter(Z=>{var oe,me,ue;return((oe=Z.attributes)==null?void 0:oe.device_class)==="speaker"||Z.entity_id.toLowerCase().includes("sonos")||((ue=(me=Z.attributes)==null?void 0:me.friendly_name)==null?void 0:ue.toLowerCase().includes("sonos"))});if(console.log("🏠 HomeDashboard Debug:",{hasInitialized:L,loading:n,error:a==null?void 0:a.message,scenesCount:x.length,lightsCount:A.length,switchesCount:b.length,devicesCount:(t==null?void 0:t.length)||0,isConnected:E,selectedScenesCount:O.size,selectedDevicesCount:o.size,filteredLights:r.length,filteredSwitches:v.length,filteredScenes:$.length,mediaPlayersCount:se.length,sonosDevicesCount:ge.length,selectedDevicesArray:Array.from(o).slice(0,5),firstFewLights:A.slice(0,3).map(Z=>Z.entity_id),firstFewSwitches:b.slice(0,3).map(Z=>Z.entity_id)}),!L&&!n&&(x.length>0||A.length>0||b.length>0)){console.log("🔧 Initializing device selections...");const Z=localStorage.getItem("selectedScenes"),oe=localStorage.getItem("selectedDevices"),me=Z?JSON.parse(Z):[],ue=oe?JSON.parse(oe):[];if(console.log("💾 Saved selections:",{savedScenes:me,savedDevices:ue}),Z&&me.length>0)console.log("📋 Using saved scenes:",me.length),c(new Set(me));else if(x.length>0){const xe=x.map(Ae=>Ae.entity_id);console.log("🎬 Auto-selecting all scenes:",xe),c(new Set(xe))}if(oe&&ue.length>0)console.log("📋 Using saved devices:",ue.length),y(new Set(ue));else if(A.length>0||b.length>0){const xe=[...A,...b].map(Ae=>Ae.entity_id);console.log("💡 Auto-selecting all devices:",xe.length,xe.slice(0,5)),y(new Set(xe))}console.log("✅ Device selection initialization complete"),G(!0)}},[x,A,b,n,L]);const q=r=>{const v=r.map($=>$.entity_id||$.id);y(new Set(v)),T(!1)},X=r=>{const v=r.map($=>$.entity_id||$.id);c(new Set(v)),M(!1)};if(n)return e.jsx(bs,{});if(a)return e.jsx(ys,{error:a,onRetry:P});const V=A.filter(r=>o.has(r.entity_id)),K=b.filter(r=>o.has(r.entity_id)),l=x.filter(r=>O.has(r.entity_id)),S=(t==null?void 0:t.filter(r=>r.entity_id.startsWith("media_player.")))||[],u=S.filter(r=>{var v,$,se;return((v=r.attributes)==null?void 0:v.device_class)==="speaker"||r.entity_id.toLowerCase().includes("sonos")||((se=($=r.attributes)==null?void 0:$.friendly_name)==null?void 0:se.toLowerCase().includes("sonos"))}),f=S.find(r=>{var v,$;return r.entity_id.includes("spotify")||(($=(v=r.attributes)==null?void 0:v.friendly_name)==null?void 0:$.toLowerCase().includes("spotify"))}),w=((t==null?void 0:t.filter(r=>r.entity_id.startsWith("alarm_control_panel.")))||[]).find(r=>{var v,$;return r.entity_id.includes("ring")||(($=(v=r.attributes)==null?void 0:v.friendly_name)==null?void 0:$.toLowerCase().includes("ring"))}),g=(t==null?void 0:t.filter(r=>r.entity_id.startsWith("climate.")))||[],I=r=>{const v=t==null?void 0:t.find($=>$.entity_id===r);v&&(D(v),k(!0))},Y=(r,v)=>{p&&p(r,v)},N=()=>{k(!1),D(null)};return e.jsxs("div",{className:"p-2 sm:p-4",children:[!E&&e.jsx("div",{className:"mb-4 p-3 bg-yellow-50 border border-yellow-200 rounded-md",children:e.jsx("p",{className:"text-yellow-800 text-sm",children:"⚠️ Connection to Home Assistant lost. Attempting to reconnect..."})}),e.jsxs("div",{className:"max-w-screen-xl mx-auto",children:[l.length>0&&e.jsxs("div",{className:"mb-6",children:[e.jsxs("div",{className:"flex items-center gap-1 mb-3",children:[e.jsx(Fe,{title:"Scenes",className:"mb-0"}),e.jsx("button",{onClick:()=>M(!0),className:"p-1 text-gray-800 hover:text-gray-600 transition-colors ml-5",children:e.jsx(Ge,{className:"w-5 h-5"})})]}),e.jsx("div",{className:"grid gap-3 sm:gap-4 grid-cols-2",children:l.map(r=>e.jsx(os,{sceneId:r.entity_id,scene:r,onActivate:C},r.entity_id))})]}),(V.length>0||K.length>0||w||g.length>0||u.length>0||f)&&e.jsxs("div",{className:"mb-6",children:[e.jsxs("div",{className:"flex items-center gap-1 mb-3",children:[e.jsx(Fe,{title:"Devices",className:"mb-0"}),e.jsx("button",{onClick:()=>T(!0),className:"p-1 text-gray-800 hover:text-gray-600 transition-colors ml-5",children:e.jsx(Ge,{className:"w-5 h-5"})})]}),e.jsxs("div",{className:"grid grid-cols-2 sm:grid-cols-4 gap-4 auto-rows-[120px]",children:[e.jsxs("div",{className:"col-span-2 grid grid-cols-2 gap-4 auto-rows-[120px]",children:[V.map(r=>e.jsx(Yt,{lightId:r.entity_id,device:r,onToggle:m,onLongPress:I},r.entity_id)),K.map(r=>e.jsx(es,{switchId:r.entity_id,device:r,onToggle:m},r.entity_id))]}),e.jsxs("div",{className:"col-span-2 sm:col-start-3 sm:col-end-5 grid grid-cols-2 gap-4 auto-rows-[120px]",children:[w&&e.jsx("div",{className:"col-span-1 row-span-2",children:e.jsx(fs,{alarmPanelId:w.entity_id,alarmData:{status:w.state||"disarmed",isConnected:w.state!=="unavailable",lastChanged:w.last_changed||null,batteryStatus:((B=w.attributes)==null?void 0:B.battery_status)||{},sensorStatuses:((H=w.attributes)==null?void 0:H.sensor_statuses)||[]},onArmHome:()=>h("alarm_control_panel","alarm_arm_home",{entity_id:w.entity_id}),onArmAway:()=>h("alarm_control_panel","alarm_arm_away",{entity_id:w.entity_id}),onDisarm:()=>h("alarm_control_panel","alarm_disarm",{entity_id:w.entity_id})})}),g.length>0&&e.jsx("div",{className:"col-span-1 row-span-2",children:e.jsx(ps,{isActive:!1,thermostatData:{currentTemp:((re=g[0].attributes)==null?void 0:re.current_temperature)||70,targetTemp:((Q=g[0].attributes)==null?void 0:Q.temperature)||70,mode:g[0].state||"off",location:(le=(te=g[0].attributes)==null?void 0:te.friendly_name)!=null&&le.toLowerCase().includes("upstairs")?"upstairs":"downstairs",isOnline:g[0].state!=="unavailable",humidity:((ae=g[0].attributes)==null?void 0:ae.current_humidity)||null,isHeating:((ie=g[0].attributes)==null?void 0:ie.hvac_action)==="heating",isCooling:((de=g[0].attributes)==null?void 0:de.hvac_action)==="cooling",fanRunning:((Ne=g[0].attributes)==null?void 0:Ne.fan_state)==="on",schedule:((_e=g[0].attributes)==null?void 0:_e.preset_mode)==="schedule"},onSetTemperature:r=>h("climate","set_temperature",{entity_id:g[0].entity_id,temperature:r}),onSetMode:r=>h("climate","set_hvac_mode",{entity_id:g[0].entity_id,hvac_mode:r})})}),(u.length>0||f)&&e.jsx("div",{className:"col-span-2 row-span-3",children:u.length>0?e.jsx(ms,{onError:r=>console.error("Sonos error:",r)},"sonos-widget"):f&&e.jsx(cs,{spotifyData:{isPlaying:f.state==="playing",currentTrack:((fe=f.attributes)==null?void 0:fe.media_title)||null,artist:((ke=f.attributes)==null?void 0:ke.media_artist)||null,album:{name:((Se=f.attributes)==null?void 0:Se.media_album)||null,imageUrl:null},isConnected:f.state!=="unavailable",isLiked:!1,duration:355e3,position:125e3,volume:Math.round((((pe=f.attributes)==null?void 0:pe.volume_level)||.6)*100)},onPlay:()=>h&&h("media_player","media_play",{entity_id:f.entity_id}),onPause:()=>h&&h("media_player","media_pause",{entity_id:f.entity_id}),onNext:()=>h&&h("media_player","media_next_track",{entity_id:f.entity_id}),onPrevious:()=>h&&h("media_player","media_previous_track",{entity_id:f.entity_id}),onVolumeChange:r=>h&&h("media_player","volume_set",{entity_id:f.entity_id,volume_level:r/100}),onToggleLike:()=>console.log("Toggle like")})})]})]})]}),(t==null?void 0:t.length)===0&&e.jsx("div",{className:"flex items-center justify-center h-64 text-center",children:e.jsxs("div",{children:[e.jsx("p",{className:"text-xl text-gray-600 mb-2",children:"No devices configured"}),e.jsx("p",{className:"text-gray-500",children:"Connect to Home Assistant to see your devices"})]})})]}),e.jsx(ts,{device:z,isVisible:d,onClose:N,onUpdateLight:Y}),e.jsx(ns,{isOpen:R,onClose:()=>T(!1),selectedDevices:[...A,...b].filter(r=>o.has(r.entity_id)).map(r=>{var v;return ee(J({},r),{id:r.entity_id,type:r.entity_id.split(".")[0],name:((v=r.attributes)==null?void 0:v.friendly_name)||r.entity_id.replace(/^[^.]+\./,"").replace(/_/g," ").replace(/\b\w/g,$=>$.toUpperCase())})}),onDevicesChange:q,availableDevices:[...A,...b].map(r=>{var v;return ee(J({},r),{id:r.entity_id,type:r.entity_id.split(".")[0],name:((v=r.attributes)==null?void 0:v.friendly_name)||r.entity_id.replace(/^[^.]+\./,"").replace(/_/g," ").replace(/\b\w/g,$=>$.toUpperCase())})})}),e.jsx(is,{isOpen:U,onClose:()=>M(!1),selectedScenes:x.filter(r=>O.has(r.entity_id)).map(r=>ee(J({},r),{id:r.entity_id})),onScenesChange:X,availableScenes:x.map(r=>{var v;return ee(J({},r),{id:r.entity_id,name:((v=r.attributes)==null?void 0:v.friendly_name)||r.entity_id})})})]})}export{Ms as default};
